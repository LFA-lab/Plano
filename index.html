<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Parcours Onboarding</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="container">
        <header>
            <div class="language-selector" role="group" aria-label="Sélecteur de langue">
                <button type="button" class="language-btn language-current" data-lang="fr" aria-pressed="true">FR</button>
                <button type="button" class="language-btn" data-lang="en" aria-pressed="false">EN</button>
            </div>
            <h1 data-i18n="title">Parcours Onboarding</h1>
            <p data-i18n="subtitle">Guide d'intégration pour les nouveaux collaborateurs</p>
        </header>

        <div class="role-switch" role="group" aria-label="Sélecteur de rôle">
            <span class="role-label" data-i18n="roleLabel">Choisissez votre parcours :</span>
            <button type="button" class="role-btn" data-role-select="arrivee" aria-pressed="true" data-i18n="roleArrivee">Premiers jours dans l'entreprise</button>
            <button type="button" class="role-btn" data-role-select="nouveau-projet" aria-pressed="false" data-i18n="roleNouveauProjet">Lancement d'un nouveau projet</button>
        </div>

        <main class="main-content">
            <!-- Vue Arrivée -->
            <div data-view="arrivee" class="view-container">
                <section class="week-section">
                    <h2 data-i18n="arriveeTitle">Arrivée - Installation & Formation initiale</h2>
                    
                    <div class="subsection">
                        <h3 data-i18n="configuration">Configuration</h3>
                        <div class="task-list">
                            <div class="task-item" data-role="both" data-duration="5-10 min" data-outcome="Demande envoyée">
                                <h4>Création compte Sitemark</h4>
                                <p>Demander la création de votre compte auprès de Antoine LE FRAPPER</p>
                                <a href="mailto:antoine.lefrapper@omexom.com?subject=Demande création compte Sitemark&body=Bonjour,%0D%0A%0D%0AJe souhaite demander la création de mon compte Sitemark.%0D%0ACordialement" class="btn btn-primary">
                                    Envoyer un mail
                                </a>
                            </div>
                            
                            <div class="task-item" data-role="apprenant" data-duration="10-15 min" data-outcome="Application installée et connectée">
                                <h4>Installation application mobile Sitemark</h4>
                                <p>Installer l'application sur votre smartphone pour la collecte de données terrain</p>
                                <div class="app-links">
                                    <a href="https://play.google.com/store/apps/details?id=com.sitemark.fieldlink" target="_blank" rel="noopener noreferrer" class="btn btn-secondary">Android</a>
                                    <a href="https://apps.apple.com/fr/app/sitemark-field-link/id6451259304" target="_blank" rel="noopener noreferrer" class="btn btn-secondary">iOS</a>
                                    <a href="https://app.sitemark.com/sites" target="_blank" rel="noopener noreferrer" class="btn btn-secondary">Site Web</a>
                                </div>
                            </div>
                            
                            <div class="task-item" data-role="manager" data-duration="5-10 min" data-outcome="Demande d'installation effectuée">
                                <h4>Installation MS Project sur votre PC</h4>
                                <p>Logiciel de gestion de projet nécessaire pour les phases de planification et d'avancement de chantier</p>
                                <span class="info-badge">Contactez le support informatique d'Omexom</span>
                            </div>
                        </div>
                    </div>

                    <div class="subsection">
                        <h3>Formations Nouveaux Arrivants</h3>
                        <div class="task-list">                        
                            <div class="task-item" data-role="apprenant" data-duration="20-30 min" data-outcome="Module terminé">
                                <h4>Formation Planificateur Teams</h4>
                                <p>Outil de planification collaborative utilisé en début de projet</p>
                                <a href="https://pontiva.thinkific.com/courses/PlanificateurTeams" target="_blank" rel="noopener noreferrer" class="btn btn-secondary">Commencer la formation</a>
                            </div>
                            
                            <div class="task-item" data-role="apprenant" data-duration="20-30 min" data-outcome="Compte Sitemark actif">
                                <h4>Formation Sitemark</h4>
                                <p>Formation sur l'outil de collecte de données terrain</p>
                                <a href="https://pontiva.thinkific.com/courses/Sitemark" target="_blank" rel="noopener noreferrer" class="btn btn-secondary">Commencer la formation</a>
                            </div>
                        </div>
                    </div>
                </section>
            </div>

            <!-- Vue Nouveau Projet -->
            <div data-view="nouveau-projet" class="view-container" style="display:none;">
                <section class="project-section">
                    <h2>Nouveau projet - Démarrage chantier / Manager</h2>
                    
                    <div class="subsection">
                        <h3>Sitemark</h3>
                        <div class="task-list">
                            <div class="task-item">
                                <label class="task-checkbox-label"><input type="checkbox" class="task-checkbox"> <span>Création du site</span></label>
                            </div>
                            <div class="task-item">
                                <label class="task-checkbox-label"><input type="checkbox" class="task-checkbox"> <span>Création du devis</span></label>
                                <a href="mailto:charles.andredumont@sitemark.com" class="btn btn-primary btn-small" style="margin-left: 12px;">Envoyer un mail</a>
                            </div>
                        </div>
                    </div>
                    
                    <div class="subsection">
                        <h3>MS Project</h3>
                        <div class="task-list">
                            <div class="task-item">
                                <label class="task-checkbox-label"><input type="checkbox" class="task-checkbox"> <span>Excel fichier</span></label>
                                <a href="./templates/FichierTypearemplir.xlsx" download class="btn btn-success btn-small" style="margin-left: 12px;">Fichier Excel type à remplir</a>
                            </div>
                            <div class="task-item">
                                <label class="task-checkbox-label"><input type="checkbox" class="task-checkbox"> <span>MS Project</span></label>
                                <a href="./templates/ModèleImport.mpt" download class="btn btn-secondary btn-small" style="margin-left: 12px;">Modèle MS Project</a>
                            </div>
                            <div class="task-item">
                                <label class="task-checkbox-label"><input type="checkbox" class="task-checkbox"> <span>Utiliser la calculatrice Pontiva</span></label>
                                <a href="./dashboard/calculatrice-travail-restant.html" target="_blank" class="btn btn-secondary btn-small" style="margin-left: 12px;">Ouvrir la calculatrice</a>
                            </div>
                        </div>
                    </div>
                    
                    <div class="subsection">
                        <h3>Pontiva - Analyse & Pilotage</h3>
                        <div class="task-list">
                            <div class="task-item">
                                <label class="task-checkbox-label"><input type="checkbox" class="task-checkbox"> <span>Ouvrir le Dashboard</span></label>
                                <a href="./dashboard/dashboard.html" target="_blank" class="btn btn-primary btn-small" style="margin-left: 12px;">Ouvrir le Dashboard</a>
                            </div>
                        </div>
                    </div>

                    <div class="subsection">
                        <h3>Macros VBA (Catalogue)</h3>
                        <div id="macros-list" class="macros-grid">
                            <!-- Chargé dynamiquement -->
                        </div>
                    </div>
                </section>
            </div>
        </main>

        <footer class="footer">
            <div class="footer-content">
                <div class="update-info" id="last-updated"></div>
            </div>
        </footer>
    </div>

    <script>
        function encodePath(path) {
            if (!path) return '';
            return path.split('/').map(segment => encodeURIComponent(segment)).join('/');
        }

        async function loadMacros() {
            const container = document.getElementById('macros-list');
            try {
                const response = await fetch('./manifest.json');
                const data = await response.json();
                container.innerHTML = '';
                
                data.macros.forEach(macro => {
                    const card = document.createElement('div');
                    card.className = 'macro-card';
                    
                    const htmlUrl = encodePath(macro.htmlFile);
                    const basUrl = encodePath(macro.basFile);
                    
                    card.innerHTML = `
                        <div class="macro-header">
                            <h5 class="macro-title">${macro.title}</h5>
                            <span class="macro-date">${macro.lastUpdated || ''}</span>
                        </div>
                        <p class="macro-description">${macro.description}</p>
                        <div class="macro-actions">
                            <a href="./${htmlUrl}" target="_blank" class="btn btn-secondary btn-small">Documentation</a>
                            <a href="./${basUrl}" download class="btn btn-primary btn-small">Télécharger</a>
                        </div>
                    `;
                    container.appendChild(card);
                });
            } catch (e) {
                console.error(e);
                container.innerHTML = '<p class="error">Erreur lors du chargement des macros.</p>';
            }
        }

        document.addEventListener('DOMContentLoaded', () => {
            loadMacros();
            
            // Switch de rôles
            document.querySelectorAll('.role-btn').forEach(btn => {
                btn.addEventListener('click', () => {
                    const role = btn.dataset.roleSelect;
                    document.querySelectorAll('.role-btn').forEach(b => b.setAttribute('aria-pressed', 'false'));
                    btn.setAttribute('aria-pressed', 'true');
                    document.querySelectorAll('.view-container').forEach(v => {
                        v.style.display = v.dataset.view === role ? 'block' : 'none';
                    });
                });
            });
        });
    </script>
    <script src="assets/onboarding.js"></script>
</body>
</html>
