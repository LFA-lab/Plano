<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Parcours Onboarding</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="container">
        <header>
            <div class="language-selector">
                <span class="language-current">
                    üá´üá∑ Fran√ßais
                </span>
                <a href="index_en.html" class="language-btn">
                    üá¨üáß English
                </a>
                <a href="index_inde.html" class="language-btn">
                    üáÆüá≥ ‡§π‡§ø‡§Ç‡§¶‡•Ä
                </a>
            </div>
            

            <h1>Parcours Onboarding</h1>
            <p>Guide d'int√©gration pour les nouveaux collaborateurs</p>
        </header>

        <main class="main-content">
            <section class="week-section">
                <h2>Semaine 1 ‚Äì Configuration et formations avant projet</h2>
                
                <div class="subsection">
                    <h3>Configuration</h3>
                    <div class="task-list">
                        <div class="task-item">
                            <h4>Cr√©ation compte Sitemark</h4>
                            <p>Demander la cr√©ation de votre compte aupr√®s de Antoine LE FRAPPER</p>
                            <a href="mailto:antoine.lefrapper@omexom.com?subject=Demande cr√©ation compte Sitemark" class="btn btn-primary">
                                Envoyer un mail
                            </a>
                        </div>
                        
                        <div class="task-item">
                            <h4>Installation application mobile Sitemark</h4>
                            <p>Installer l'application sur votre smartphone pour la collecte de donn√©es terrain</p>
                            <div class="app-links">
                                <a href="https://play.google.com/store/apps/details?id=com.sitemark.fieldlink&pcampaignid=web_share" target="_blank" class="btn btn-secondary">
                                    Android
                                </a>
                                <a href="https://apps.apple.com/fr/app/sitemark-field-link/id6451259304" target="_blank" class="btn btn-secondary">
                                    iOS
                                </a>
                                <a href="https://app.sitemark.com/sites" target="_blank" class="btn btn-secondary">
                                    Site Web
                                </a>
                            </div>
                        </div>
                        
                        <div class="task-item">
                            <h4>Installation MS Project sur votre PC</h4>
                            <p>Logiciel de gestion de projet n√©cessaire pour les phases de planification et d'avancement de chantier</p>
                            <span class="info-badge">Contactez le support informatique d'Omexom</span>
                        </div>
                    </div>
                </div>

                <div class="subsection">
                    <h3>Formations Nouveaux Arrivants</h3>
                    <div class="task-list">                        
                        <div class="task-item">
                            <h4>Formation Planificateur Teams</h4>
                            <p>Outil de planification collaborative utilis√© en d√©but de projet</p>
                            <a href="https://pontiva.thinkific.com/courses/PlanificateurTeams" target="_blank" class="btn btn-secondary">
                                Commencer la formation
                            </a>
                        </div>
                        
                        <div class="task-item">
                            <h4>Formation Sitemark</h4>
                            <p>Formation sur l'outil de collecte de donn√©es terrain</p>
                            <a href="https://pontiva.thinkific.com/courses/Sitemark" target="_blank" class="btn btn-secondary">
                                Acc√©der au cours
                            </a>
                        </div>
                    </div>
                </div>
            </section>

            <section class="project-section">
                <h2>Projet r√©el en main ‚Äì Ce qu'il faut faire √† ce moment-l√†</h2>
                
                <div class="task-list">
                    <div class="task-item">
                        <h4>Revoir la formation Planificateur Teams</h4>
                        <p>Rafra√Æchir ses connaissances pendant votre projet r√©el</p>
                        <a href="https://pontiva.thinkific.com/courses/PlanificateurTeams" target="_blank" class="btn btn-secondary">
                            R√©viser la formation
                        </a>
                    </div>
                    
                    <div class="task-item">
                        <h4> Faire la formation Sitemark</h4>
                        <p>Faire la formation en m√™me temps que votre projet</p>
                        <a href="https://pontiva.thinkific.com/courses/Sitemark" target="_blank" class="btn btn-secondary">
                            R√©viser la formation
                        </a>
                    </div>
                    <div class="task-item">
                        <h4>Formation MS Projet sur votre projet r√©el </h4>
                        <a href="https://pontiva.thinkific.com/courses/processusmsparriv%C3%A9e" target="_blank" class="btn btn-secondary">
                            Aller faire votre projet
                        </a>
                    </div>
                    
                    
                    <div class="task-item">
                        <h4>Contacter les interlocuteurs Sitemark</h4>
                        <p>Prendre contact avec l'√©quipe support pour accompagnement projet</p>
                        <div class="contact-grid">
                            <div class="contact-item">
                                <strong>Support technique :</strong>
                                <a href="mailto:idris.abidi@sitemark.com" class="btn btn-contact">
                                    idris.abidi@sitemark.com
                                </a>
                            </div>
                            <div class="contact-item">
                                <strong>Commercial :</strong>
                                <a href="mailto:charles.andredumont@sitemark.com" class="btn btn-contact">
                                    charles.andredumont@sitemark.com
                                </a>
                            </div>
                            <div class="contact-item">
                                <strong>Op√©rations :</strong>
                                <a href="mailto:operations1@sitemark.com" class="btn btn-contact">
                                    operations1@sitemark.com
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <section class="resources-section">
                <h3>üìö Ressources compl√©mentaires</h3>
                
                <!-- Section Macros VBA dynamique -->
                <div class="macros-section">
                    <h4>üîß Macros VBA</h4>
                    <div id="macros-list" class="macros-grid">
                        <div class="loading-message">Chargement des macros...</div>
                    </div>
                </div>
                
                <!-- Autres ressources -->
                <div class="other-resources">
                    <h4>üîó Autres ressources</h4>
                    <div class="resource-item">
                        <h5>Planificateur Teams: Plan EPC de base √† mettre dans votre GO-Chantier</h5>
                        <a href="https://teams.microsoft.com/l/entity/com.microsoft.teamspace.tab.planner/mytasks?tenantId=cae7d061-08f3-40dd-80c3-3c0b8889224a&webUrl=https%3A%2F%2Ftasks.teams.microsoft.com%2Fteamsui%2FpersonalApp%2Falltasklists&context=%7B%22subEntityId%22%3A%22%2Fv1%2Fpremiumplan%2Ff19fc843-87b0-4cc2-96bd-c0cde78f7f79%2Forg%2F59675cc6-bab9-416e-b01c-04b99ae59f69%22%7D" target="_blank" class="btn btn-primary">
                            Ouvrir Teams
                        </a>
                    </div>
                </div>
            </section>
        </main>

        <footer class="footer">
            <div class="footer-content">
                <div class="language-footer">
                    <a href="index_en.html">üá¨üáß</a>
                    <a href="index_inde.html">üáÆüá≥</a>
                </div>
                <div class="update-info">
                    Derni√®re mise √† jour : ao√ªt 2025
                </div>
            </div>
        </footer>
    </div>

    <script>
        // Chargement dynamique des macros depuis manifest.json
        async function loadMacros() {
            const macrosContainer = document.getElementById('macros-list');
            
            try {
                const response = await fetch('./macros/manifest.json');
                
                if (!response.ok) {
                    throw new Error(`Erreur HTTP: ${response.status}`);
                }
                
                const data = await response.json();
                
                // Vider le message de chargement
                macrosContainer.innerHTML = '';
                
                // G√©n√©rer uniquement les cartes demand√©es
                const allowedNames = new Set([
                    'avancement-physique-vs-heures',
                    'calculatrice-reste-a-faire',
                    'creation-ms-project'
                ]);
                data.macros.filter(m => allowedNames.has(m.name)).forEach(macro => {
                    const macroCard = document.createElement('div');
                    macroCard.className = 'macro-card';
                    
                    // Encoder les URLs pour g√©rer les espaces et caract√®res sp√©ciaux
                    const encodedHtmlFile = encodeURIComponent(macro.htmlFile).replace(/%2F/g, '/');
                    const encodedBasFile = encodeURIComponent(macro.basFile).replace(/%2F/g, '/');
                    
                    let actionsHtml = `
                        <a href="./macros/${encodedHtmlFile}" target="_blank" class="btn btn-secondary btn-small">
                            üìñ Documentation
                        </a>
                        <a href="./macros/${encodedBasFile}" download class="btn btn-primary btn-small">
                            üíæ T√©l√©charger
                        </a>
                    `;
                    // Ajout du bouton Excel pour la macro Import Simple
                    if (macro.name === 'creation-ms-project') {
                        actionsHtml += `
                            <a href="./macros/Macro MSP/Cr√©ation MS Project/ImportSimple/FichierTypearemplir.xlsm" download class="btn btn-success btn-small" style="margin-top:4px;">
                                üì• Fichier Excel type √† remplir
                            </a>
                        `;
                    }
                    
                    // Ajouter les actions sp√©cifiques pour la calculatrice reste √† faire
                    if (macro.name === 'calculatrice-reste-a-faire') {
                        actionsHtml = `
                            <a href="./macros/${encodedHtmlFile}" target="_blank" class="btn btn-secondary btn-small">
                                üìñ Documentation
                            </a>
                            <button onclick="downloadFormFiles('${macro.name}')" class="btn btn-primary btn-small">
                                üì¶ T√©l√©charger Forms (.frm + .frx)
                            </button>
                        `;
                    }
                    
                    macroCard.innerHTML = `
                        <div class="macro-header">
                            <h5 class="macro-title">
                                <a href="./macros/${encodedHtmlFile}" target="_blank" class="macro-link">
                                    ${macro.title}
                                </a>
                            </h5>
                            ${macro.lastUpdated ? `<span class="macro-date">Mis √† jour le ${macro.lastUpdated}</span>` : ''}
                        </div>
                        <p class="macro-description">${macro.description}</p>
                        <div class="macro-actions">
                            ${actionsHtml}
                        </div>
                    `;
                    
                    macrosContainer.appendChild(macroCard);
                });
                
            } catch (error) {
                console.error('Erreur lors du chargement des macros:', error);
                macrosContainer.innerHTML = `
                    <div class="error-message">
                        ‚ùå Impossible de charger les macros VBA
                        <br><small>V√©rifiez que le fichier manifest.json est accessible</small>
                    </div>
                `;
            }
        }
        
        // Fonction pour t√©l√©charger les fichiers forms en ZIP
        async function downloadFormFiles(macroName) {
            try {
                // R√©cup√©rer les informations de la macro
                const response = await fetch('./macros/manifest.json');
                const data = await response.json();
                const macro = data.macros.find(m => m.name === macroName);
                
                if (!macro || !macro.hasZipDownload) {
                    alert('T√©l√©chargement ZIP non disponible pour cette macro.');
                    return;
                }
                
                // Cr√©er un zip avec JSZip
                const JSZip = (await import('https://cdn.jsdelivr.net/npm/jszip@3.10.1/+esm')).default;
                const zip = new JSZip();
                
                // T√©l√©charger et ajouter le fichier .frm
                const frmResponse = await fetch(`./macros/${encodeURIComponent(macro.frmFile).replace(/%2F/g, '/')}`);
                const frmBlob = await frmResponse.blob();
                zip.file('datecalcul.frm', frmBlob);
                
                // T√©l√©charger et ajouter le fichier .frx
                const frxResponse = await fetch(`./macros/${encodeURIComponent(macro.frxFile).replace(/%2F/g, '/')}`);
                const frxBlob = await frxResponse.blob();
                zip.file('datecalcul.frx', frxBlob);
                
                // G√©n√©rer et t√©l√©charger le ZIP
                const zipBlob = await zip.generateAsync({type: 'blob'});
                const url = URL.createObjectURL(zipBlob);
                const a = document.createElement('a');
                a.href = url;
                a.download = 'calculatrice_datecalcul_forms.zip';
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                URL.revokeObjectURL(url);
                
            } catch (error) {
                console.error('Erreur lors du t√©l√©chargement ZIP:', error);
                alert('Erreur lors du t√©l√©chargement des fichiers. Veuillez r√©essayer.');
            }
        }
        
        // Charger les macros au chargement de la page
        document.addEventListener('DOMContentLoaded', loadMacros);
    </script>
</body>
</html>