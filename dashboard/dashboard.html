<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard Interne</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #f5f5f5;
            padding: 20px;
        }
        
        .dashboard-container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border: 2px solid #000;
            padding: 20px;
        }
        
        /* En-t√™te */
        h1 {
            font-size: 16px;
            font-weight: bold;
            margin-bottom: 20px;
            text-align: left;
        }
        
        /* Layout principal */
        .main-layout {
            margin-top: 20px;
        }
        
        /* Section gauche */
        .left-section {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }
        
        /* Boutons et onglets */
        .tabs-row {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
        }
        
        .tab-button {
            padding: 8px 16px;
            background: white;
            border: 1px solid #000;
            cursor: pointer;
            font-size: 11px;
            font-weight: 600;
            transition: all 0.2s;
        }
        
        .tab-button:hover {
            background: #e8e8e8;
        }
        
        .tab-button.active {
            background: #d0d0d0;
            border-width: 2px;
        }
        
        /* Menu d√©roulant */
        .zone-select {
            padding: 7px 12px;
            border: 1px solid #000;
            font-size: 11px;
            background: white;
            cursor: pointer;
        }
        
        /* Section graphique */
        .chart-section {
            border: 1px solid #000;
            padding: 15px;
        }
        
        .chart-title {
            text-align: center;
            font-size: 12px;
            font-weight: normal;
            margin-bottom: 15px;
        }
        
        .chart-container-wrapper {
            position: relative;
            height: 280px;
        }
        
        /* Labels verticaux */
        .chart-labels {
            display: flex;
            flex-direction: column;
            gap: 28px;
            position: absolute;
            left: 0;
            top: 20px;
        }
        
        .chart-label {
            font-size: 9px;
            text-align: right;
            width: 120px;
        }
        
        .chart-label.rotated {
            writing-mode: vertical-rl;
            transform: rotate(180deg);
            width: auto;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: flex-end;
        }
        
        /* Zone de barres */
        .bars-container {
            margin-left: 130px;
            margin-top: 15px;
            position: relative;
        }
        
        .bar-row {
            display: flex;
            gap: 5px;
            margin-bottom: 10px;
            height: 22px;
            align-items: center;
        }
        
        .bar {
            height: 20px;
            background: linear-gradient(to right, #FF0000 0%, #FFFF00 50%, #00B050 100%);
            position: relative;
        }
        
        /* Axe X */
        .x-axis {
            display: flex;
            justify-content: space-between;
            margin-left: 130px;
            margin-top: 5px;
            padding-right: 10px;
            border-top: 1px solid #000;
            padding-top: 5px;
        }
        
        .x-axis-label {
            font-size: 10px;
        }
        
        /* Vue cach√©e par d√©faut */
        .view-section {
            display: none;
        }
        
        .view-section.active {
            display: block;
        }
        
        /* Page d'accueil */
        .home-view {
            padding: 40px 20px;
            text-align: center;
        }
        
        .home-title {
            font-size: 24px;
            font-weight: bold;
            margin-bottom: 40px;
            color: #333;
        }
        
        .dashboard-cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 25px;
            max-width: 1000px;
            margin: 0 auto;
        }
        
        .dashboard-card {
            background: white;
            border: 2px solid #000;
            padding: 40px 30px;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
        }
        
        .dashboard-card:hover {
            background: #f0f0f0;
            transform: translateY(-5px);
            box-shadow: 0 8px 16px rgba(0,0,0,0.2);
        }
        
        .dashboard-card-icon {
            font-size: 48px;
            margin-bottom: 20px;
        }
        
        .dashboard-card-title {
            font-size: 20px;
            font-weight: bold;
            margin-bottom: 10px;
            color: #333;
        }
        
        .dashboard-card-description {
            font-size: 12px;
            color: #666;
            line-height: 1.5;
        }
        
        /* Bouton retour */
        .back-button {
            padding: 8px 16px;
            background: #666;
            color: white;
            border: none;
            cursor: pointer;
            font-size: 11px;
            font-weight: 600;
            transition: all 0.2s;
            margin-bottom: 15px;
        }
        
        .back-button:hover {
            background: #444;
        }
        
        /* Navigation dans les sous-vues */
        .sub-navigation {
            display: none;
            margin-bottom: 15px;
        }
        
        .sub-navigation.active {
            display: block;
        }
        
        /* Dashboard √âlectrique */
        .electrical-dashboard {
            margin-top: 20px;
        }
        
        .electrical-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            gap: 15px;
        }
        
        .electrical-left {
            display: flex;
            gap: 10px;
            align-items: center;
        }
        
        .btn-view-all {
            padding: 8px 16px;
            background: white;
            border: 1px solid #000;
            cursor: pointer;
            font-size: 11px;
            font-weight: 600;
            transition: all 0.2s;
        }
        
        .btn-view-all:hover {
            background: #e8e8e8;
        }
        
        .select-action {
            padding: 7px 12px;
            border: 1px solid #000;
            font-size: 11px;
            background: white;
            cursor: pointer;
            min-width: 150px;
        }
        
        .electrical-right {
            display: flex;
            gap: 10px;
            align-items: center;
        }
        
        .btn-export {
            padding: 8px 16px;
            background: #2e7d32;
            color: white;
            border: 1px solid #1b5e20;
            cursor: pointer;
            font-size: 11px;
            font-weight: 600;
            transition: all 0.2s;
        }
        
        .btn-export:hover {
            background: #1b5e20;
        }
        
        /* Filtres g√©ographiques */
        .electrical-filters {
            display: flex;
            gap: 15px;
            align-items: center;
            margin-bottom: 20px;
            padding: 15px;
            background: #f5f5f5;
            border: 1px solid #000;
            flex-wrap: wrap;
        }
        
        .filter-group {
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .filter-label {
            font-size: 11px;
            font-weight: 600;
        }
        
        .filter-select {
            padding: 7px 12px;
            border: 1px solid #000;
            font-size: 11px;
            background: white;
            cursor: pointer;
            min-width: 140px;
        }
        
        .btn-reset-filters {
            padding: 7px 14px;
            background: #666;
            color: white;
            border: 1px solid #444;
            cursor: pointer;
            font-size: 11px;
            font-weight: 600;
            transition: all 0.2s;
        }
        
        .btn-reset-filters:hover {
            background: #444;
        }
        
        /* Tableau de progression */
        .progress-table {
            width: 100%;
            border-collapse: collapse;
            border: 1px solid #000;
            margin-bottom: 20px;
        }
        
        .progress-table th,
        .progress-table td {
            border: 1px solid #000;
            padding: 8px;
            text-align: center;
            font-size: 11px;
        }
        
        .progress-table th {
            background: #e0e0e0;
            font-weight: 600;
        }
        
        .progress-table td.action-name {
            text-align: left;
            font-weight: 600;
            background: #f5f5f5;
        }
        
        .progress-table td.percentage {
            font-weight: 600;
        }
        
        .progress-table td.percentage.low {
            color: #d32f2f;
        }
        
        .progress-table td.percentage.medium {
            color: #f57c00;
        }
        
        .progress-table td.percentage.high {
            color: #388e3c;
        }
        
        .comparatif-note {
            font-size: 11px;
            color: #666;
            font-style: italic;
            margin-top: 10px;
            padding: 10px;
            background: #f9f9f9;
            border: 1px solid #ddd;
        }
        
        /* Vue Chef d'√©quipe - Reste √† faire */
        .chef-equipe-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }
        
        .onduleur-card {
            border: 2px solid #000;
            padding: 15px;
            background: white;
        }
        
        .onduleur-card-header {
            font-size: 14px;
            font-weight: bold;
            margin-bottom: 10px;
            padding-bottom: 8px;
            border-bottom: 2px solid #000;
            text-align: center;
        }
        
        .onduleur-action-row {
            display: grid;
            grid-template-columns: 140px 1fr 100px;
            align-items: center;
            gap: 10px;
            padding: 8px 0;
            border-bottom: 1px solid #e0e0e0;
        }
        
        .onduleur-action-row:last-child {
            border-bottom: none;
        }
        
        .onduleur-action-label {
            font-size: 11px;
            font-weight: 600;
        }
        
        .onduleur-bar-container {
            background: white;
            border: 2px solid #000;
            height: 20px;
            position: relative;
        }
        
        .onduleur-bar {
            height: 100%;
            background: #f4b400;
            border-right: 2px solid #000;
            transition: width 0.3s ease;
        }
        
        .onduleur-percentage {
            font-size: 10px;
            font-weight: bold;
            text-align: right;
        }
        
        /* Dashboard Financier */
        .financial-dashboard {
            margin-top: 20px;
        }
        
        .financial-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding: 15px;
            background: #f5f5f5;
            border: 1px solid #000;
        }
        
        .date-selector-container {
            display: flex;
            gap: 10px;
            align-items: center;
        }
        
        .date-selector-label {
            font-size: 11px;
            font-weight: 600;
        }
        
        .date-selector {
            padding: 7px 12px;
            border: 1px solid #000;
            font-size: 11px;
            background: white;
            cursor: pointer;
        }
        
        .financial-summary {
            text-align: right;
        }
        
        .financial-summary-title {
            font-size: 10px;
            color: #666;
            margin-bottom: 5px;
        }
        
        .financial-summary-amount {
            font-size: 20px;
            font-weight: bold;
            color: #2e7d32;
        }
        
        /* Tableau des tranches */
        .tranches-table {
            width: 100%;
            border-collapse: collapse;
            border: 1px solid #000;
            margin-bottom: 20px;
        }
        
        .tranches-table th,
        .tranches-table td {
            border: 1px solid #000;
            padding: 10px;
            font-size: 11px;
        }
        
        .tranches-table th {
            background: #e0e0e0;
            font-weight: 600;
            text-align: center;
        }
        
        .tranches-table td.tranche-name {
            font-weight: 600;
            background: #f5f5f5;
            width: 120px;
        }
        
        .tranches-table td.sub-category {
            padding-left: 30px;
            font-size: 10px;
            background: #fafafa;
        }
        
        .tranches-table td.amount {
            text-align: right;
            font-weight: 600;
            color: #2e7d32;
        }
        
        .tranches-table td.percentage {
            text-align: center;
            font-weight: 600;
        }
        
        /* Timeline mensuelle */
        .timeline-container {
            margin-top: 20px;
            overflow-x: auto;
        }
        
        .timeline-header {
            font-size: 12px;
            font-weight: 600;
            margin-bottom: 10px;
        }
        
        .timeline-grid {
            display: grid;
            grid-template-columns: 150px 1fr;
            gap: 10px;
            min-width: 800px;
        }
        
        .timeline-labels {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }
        
        .timeline-label {
            font-size: 10px;
            font-weight: 600;
            height: 30px;
            display: flex;
            align-items: center;
        }
        
        .timeline-bars {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }
        
        .timeline-bar-row {
            display: flex;
            align-items: center;
            height: 30px;
            position: relative;
            background: #f0f0f0;
            border: 1px solid #ddd;
        }
        
        .timeline-bar {
            height: 100%;
            background: linear-gradient(to right, #FF5722 0%, #FFC107 50%, #4CAF50 100%);
            transition: width 0.3s ease;
            position: relative;
        }
        
        .timeline-bar-label {
            position: absolute;
            right: 5px;
            font-size: 10px;
            font-weight: 600;
            color: #fff;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.5);
        }
        
        .timeline-months {
            display: flex;
            justify-content: space-between;
            margin-top: 5px;
            font-size: 9px;
            color: #666;
        }
        
        /* Total facturable */
        .total-section {
            margin-top: 20px;
            padding: 15px;
            background: #e8f5e9;
            border: 2px solid #4caf50;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .total-label {
            font-size: 14px;
            font-weight: 600;
        }
        
        .total-amount {
            font-size: 24px;
            font-weight: bold;
            color: #2e7d32;
        }
        
        /* Vue Tranch√©es */
        .tranchees-view {
            padding: 20px;
            border: 1px solid #000;
        }
        
        .tranchees-title {
            text-align: center;
            font-size: 18px;
            font-weight: bold;
            margin-bottom: 10px;
        }
        
        .tranchees-subtitle {
            text-align: center;
            font-size: 13px;
            margin-bottom: 30px;
            color: #666;
        }
        
        .tranchees-grid {
            max-width: 900px;
            margin: 0 auto;
        }
        
        .tranchees-row {
            display: grid;
            grid-template-columns: 200px 1fr 80px;
            align-items: center;
            gap: 15px;
            margin-bottom: 15px;
        }
        
        .tranchees-label {
            font-size: 12px;
            font-weight: 600;
            text-align: left;
        }
        
        .tranchees-bar-container {
            background: white;
            border: 2px solid #000;
            height: 24px;
            position: relative;
        }
        
        .tranchees-bar {
            height: 100%;
            background: #FFFF00;
            border-right: 2px solid #000;
            transition: width 0.3s ease;
        }
        
        .tranchees-percentage {
            font-size: 12px;
            font-weight: bold;
            text-align: right;
        }
        
        .tranchees-row.general {
            margin-top: 30px;
            padding-top: 20px;
            border-top: 2px solid #000;
        }
        
        .tranchees-row.general .tranchees-label {
            font-size: 14px;
            font-weight: bold;
        }
        
        .tranchees-row.general .tranchees-percentage {
            font-size: 14px;
        }
        
        /* Vue principale m√©canique - Liste d'avancements */
        .mechanical-progress-view {
            padding: 20px;
            border: 1px solid #000;
        }
        
        .mechanical-progress-title {
            text-align: center;
            font-size: 16px;
            font-weight: bold;
            margin-bottom: 30px;
        }
        
        .mechanical-progress-grid {
            max-width: 900px;
            margin: 0 auto;
        }
        
        .mechanical-progress-row {
            display: grid;
            grid-template-columns: 220px 1fr 80px;
            align-items: center;
            gap: 15px;
            margin-bottom: 15px;
        }
        
        .mechanical-progress-label {
            font-size: 12px;
            font-weight: 600;
            text-align: left;
        }
        
        .mechanical-progress-bar-container {
            background: white;
            border: 2px solid #000;
            height: 24px;
            position: relative;
        }
        
        .mechanical-progress-bar {
            height: 100%;
            background: #f4b400;
            border-right: 2px solid #000;
            transition: width 0.3s ease;
        }
        
        .mechanical-progress-percentage {
            font-size: 12px;
            font-weight: bold;
            text-align: right;
        }
        
        .mechanical-progress-row.general {
            margin-top: 30px;
            padding-top: 20px;
            border-top: 2px solid #000;
        }
        
        .mechanical-progress-row.general .mechanical-progress-label {
            font-size: 14px;
            font-weight: bold;
        }
        
        .mechanical-progress-row.general .mechanical-progress-percentage {
            font-size: 14px;
        }
        
        /* Vue S-Curve */
        .scurve-view {
            padding: 20px;
            border: 1px solid #000;
        }
        
        .scurve-header {
            text-align: center;
            margin-bottom: 20px;
        }
        
        .scurve-title {
            font-size: 18px;
            font-weight: bold;
            margin-bottom: 15px;
        }
        
        .scurve-instruction {
            font-size: 11px;
            color: #666;
            margin-bottom: 8px;
            line-height: 1.5;
        }
        
        .scurve-chart-container {
            margin: 30px auto;
            max-width: 1100px;
            background: white;
            padding: 20px;
            border: 1px solid #000;
        }
        
        .scurve-canvas-wrapper {
            position: relative;
            height: 450px;
        }
        
        .scurve-legend {
            display: flex;
            justify-content: center;
            gap: 30px;
            margin-top: 20px;
            flex-wrap: wrap;
        }
        
        .scurve-legend-item {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 11px;
        }
        
        .scurve-legend-color {
            width: 30px;
            height: 3px;
            border: 1px solid #000;
        }
        
        .scurve-legend-color.line-blue {
            background: #2563eb;
        }
        
        .scurve-legend-color.line-red {
            background: #dc2626;
            border-style: dashed;
        }
        
        .scurve-legend-color.bar-blue {
            background: #3b82f6;
            height: 15px;
        }
        
        .scurve-legend-color.bar-red {
            background: #ef4444;
            height: 15px;
        }
    </style>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
</head>
<body>
    <div class="dashboard-container">
        <h1>STRUCTURE DU DASHBOARD INTERNE</h1>
        
        <!-- Page d'accueil -->
        <div id="home-view" class="view-section active">
            <div class="home-view">
                <div class="home-title">Choisissez votre dashboard</div>
                <div class="dashboard-cards">
                    <div class="dashboard-card" data-dashboard="mechanical">
                        <div class="dashboard-card-icon">‚öôÔ∏è</div>
                        <div class="dashboard-card-title">Dashboard M√©canique</div>
                        <div class="dashboard-card-description">
                            Suivi des forages, micropieux, structures et contr√¥les qualit√© associ√©s
                        </div>
                    </div>
                    <div class="dashboard-card" data-dashboard="electrical">
                        <div class="dashboard-card-icon">‚ö°</div>
                        <div class="dashboard-card-title">Dashboard √âlectrique</div>
                        <div class="dashboard-card-description">
                            Suivi des actions √©lectriques par onduleur (tirage c√¢bles, raccordement, tests, etc.)
                        </div>
                    </div>
                    <div class="dashboard-card" data-dashboard="financial">
                        <div class="dashboard-card-icon">üí∞</div>
                        <div class="dashboard-card-title">Dashboard Financier</div>
                        <div class="dashboard-card-description">
                            Suivi des montants facturables par tranche selon l'avancement (MECA, MOD, ELEC)
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Dashboard M√©canique -->
        <div id="mechanical-view" class="view-section">
            <button class="back-button" id="btnBackFromMeca">‚Üê Retour √† l'accueil</button>
            
            <!-- Premi√®re rang√©e d'onglets -->
            <div class="tabs-row sub-navigation active">
                <button class="tab-button active" data-view="main" data-category="forages">Forages</button>
                <button class="tab-button" data-view="main" data-category="micropieux">Micropieux</button>
                <button class="tab-button" data-view="main" data-category="structures">Structures</button>
                <button class="tab-button" data-view="tranchees">Tranch√©es</button>
                <button class="tab-button" data-view="scurve">S-Curve</button>
            </div>
            
            <!-- Menu d√©roulant des sous-zones -->
            <div class="tabs-row sub-navigation active">
            <select class="zone-select" id="zoneSelect">
                <option value="">Toutes les sous-zones</option>
                <option value="zone1a">Sous-zone A</option>
                <option value="zone1b">Sous-zone B</option>
                <option value="zone1c">Sous-zone C</option>
                <option value="zone1d">Sous-zone D</option>
            </select>
            </div>
            
            <!-- Vue principale m√©canique -->
            <div class="main-layout" id="mechanical-main-view">
                <div class="mechanical-progress-view">
                    <div class="mechanical-progress-grid">
                        <div class="mechanical-progress-row">
                            <div class="mechanical-progress-label">Avancement Pieux</div>
                            <div class="mechanical-progress-bar-container">
                                <div class="mechanical-progress-bar" id="progress-pieux" style="width: 100%;"></div>
                            </div>
                            <div class="mechanical-progress-percentage">100,0%</div>
                        </div>
                        
                        <div class="mechanical-progress-row">
                            <div class="mechanical-progress-label">Avancement Arbal√©triers</div>
                            <div class="mechanical-progress-bar-container">
                                <div class="mechanical-progress-bar" id="progress-arbaletriers" style="width: 100%;"></div>
                            </div>
                            <div class="mechanical-progress-percentage">100,0%</div>
                        </div>
                        
                        <div class="mechanical-progress-row">
                            <div class="mechanical-progress-label">Avancement Pannes</div>
                            <div class="mechanical-progress-bar-container">
                                <div class="mechanical-progress-bar" id="progress-pannes" style="width: 100%;"></div>
                            </div>
                            <div class="mechanical-progress-percentage">100,0%</div>
                        </div>
                        
                        <div class="mechanical-progress-row">
                            <div class="mechanical-progress-label">Avancement Structures</div>
                            <div class="mechanical-progress-bar-container">
                                <div class="mechanical-progress-bar" id="progress-structures" style="width: 100%;"></div>
                            </div>
                            <div class="mechanical-progress-percentage">100,0%</div>
                        </div>
                        
                        <div class="mechanical-progress-row">
                            <div class="mechanical-progress-label">Avancement Modules</div>
                            <div class="mechanical-progress-bar-container">
                                <div class="mechanical-progress-bar" id="progress-modules" style="width: 100%;"></div>
                            </div>
                            <div class="mechanical-progress-percentage">100,0%</div>
                        </div>
                        
                        <div class="mechanical-progress-row general">
                            <div class="mechanical-progress-label">Avancement g√©n√©ral</div>
                            <div class="mechanical-progress-bar-container">
                                <div class="mechanical-progress-bar" id="progress-general" style="width: 100%;"></div>
                            </div>
                            <div class="mechanical-progress-percentage">100%</div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Vue Tranch√©es -->
            <div class="tranchees-view" id="mechanical-tranchees-view" style="display: none;">
                <div class="tranchees-title">TRANCH√âES</div>
                <div class="tranchees-subtitle">Ouverture des sols par onduleur</div>
                
                <div class="tranchees-grid">
                    <div class="tranchees-row">
                        <div class="tranchees-label">Avancement OND 1</div>
                        <div class="tranchees-bar-container">
                            <div class="tranchees-bar" id="tranchees-ond1" style="width: 100%;"></div>
                        </div>
                        <div class="tranchees-percentage">100,0%</div>
                    </div>
                    
                    <div class="tranchees-row">
                        <div class="tranchees-label">Avancement OND 2</div>
                        <div class="tranchees-bar-container">
                            <div class="tranchees-bar" id="tranchees-ond2" style="width: 100%;"></div>
                        </div>
                        <div class="tranchees-percentage">100,0%</div>
                    </div>
                    
                    <div class="tranchees-row">
                        <div class="tranchees-label">Avancement OND 3</div>
                        <div class="tranchees-bar-container">
                            <div class="tranchees-bar" id="tranchees-ond3" style="width: 100%;"></div>
                        </div>
                        <div class="tranchees-percentage">100,0%</div>
                    </div>
                    
                    <div class="tranchees-row">
                        <div class="tranchees-label">Avancement OND 4</div>
                        <div class="tranchees-bar-container">
                            <div class="tranchees-bar" id="tranchees-ond4" style="width: 100%;"></div>
                        </div>
                        <div class="tranchees-percentage">100,0%</div>
                    </div>
                    
                    <div class="tranchees-row">
                        <div class="tranchees-label">Avancement OND 5</div>
                        <div class="tranchees-bar-container">
                            <div class="tranchees-bar" id="tranchees-ond5" style="width: 100%;"></div>
                        </div>
                        <div class="tranchees-percentage">100,0%</div>
                    </div>
                    
                    <div class="tranchees-row general">
                        <div class="tranchees-label">Avancement g√©n√©ral</div>
                        <div class="tranchees-bar-container">
                            <div class="tranchees-bar" id="tranchees-general" style="width: 100%;"></div>
                        </div>
                        <div class="tranchees-percentage">100%</div>
                    </div>
                </div>
            </div>
            
            <!-- Vue S-Curve -->
            <div class="scurve-view" id="mechanical-scurve-view" style="display: none;">
                <div class="scurve-header">
                    <div class="scurve-title">MECA</div>
                    <div class="scurve-instruction">Mettre uniquement les t√¢ches r√©alis√©es en barre d'avancement</div>
                    <div class="scurve-instruction">Rajouter un suivi en S Curve pour vision de la d√©rive par t√¢che</div>
                </div>
                
                <div class="scurve-chart-container">
                    <div class="scurve-canvas-wrapper">
                        <canvas id="scurveChart"></canvas>
                    </div>
                    
                    <div class="scurve-legend">
                        <div class="scurve-legend-item">
                            <div class="scurve-legend-color line-blue"></div>
                            <span>Cumul√© r√©el</span>
                        </div>
                        <div class="scurve-legend-item">
                            <div class="scurve-legend-color bar-blue"></div>
                            <span>R√©el</span>
                        </div>
                        <div class="scurve-legend-item">
                            <div class="scurve-legend-color line-red"></div>
                            <span>Cumul√© planifi√©</span>
                        </div>
                        <div class="scurve-legend-item">
                            <div class="scurve-legend-color bar-red"></div>
                            <span>Planifi√©</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Dashboard √âlectrique -->
        <div id="electrical-view" class="view-section">
            <button class="back-button" id="btnBackFromElec">‚Üê Retour √† l'accueil</button>
            
            <div class="electrical-dashboard">
                <div class="electrical-header">
                    <div class="electrical-left">
                        <button class="btn-view-all" id="btnViewAll">Tout voir</button>
                        <button class="btn-view-all" id="btnResteAFaire">Reste √† faire</button>
                        <select class="select-action" id="selectAction">
                            <option value="">actions √©lec</option>
                            <option value="action1">Action 1 - Tirage c√¢bles</option>
                            <option value="action2">Action 2 - Raccordement</option>
                            <option value="action3">Action 3 - Tests</option>
                            <option value="action4">Action 4 - Mise en service</option>
                        </select>
                    </div>
                    <div class="electrical-right">
                        <button class="btn-export" id="btnExportElec">üìä Exporter √©lec</button>
                    </div>
                </div>
                
                <!-- Filtres g√©ographiques -->
                <div class="electrical-filters">
                    <div class="filter-group">
                        <label for="filterZone" class="filter-label">Zone :</label>
                        <select class="filter-select" id="filterZone">
                            <option value="">Toutes les zones</option>
                            <option value="zone1">Zone 1</option>
                            <option value="zone2">Zone 2</option>
                            <option value="zone3">Zone 3</option>
                        </select>
                    </div>
                    <div class="filter-group">
                        <label for="filterSousZone" class="filter-label">Sous-zone :</label>
                        <select class="filter-select" id="filterSousZone">
                            <option value="">Toutes les sous-zones</option>
                            <option value="1.1">1.1</option>
                            <option value="1.2">1.2</option>
                            <option value="2.1">2.1</option>
                            <option value="2.2">2.2</option>
                        </select>
                    </div>
                    <div class="filter-group">
                        <label for="filterPTR" class="filter-label">PTR :</label>
                        <select class="filter-select" id="filterPTR">
                            <option value="">Tous les PTR</option>
                            <option value="PTR1.1-1">PTR1.1-1</option>
                            <option value="PTR1.1-2">PTR1.1-2</option>
                            <option value="PTR1.2-1">PTR1.2-1</option>
                            <option value="PTR2.1-1">PTR2.1-1</option>
                        </select>
                    </div>
                    <div class="filter-group">
                        <button class="btn-reset-filters" id="btnResetFilters">üîÑ R√©initialiser</button>
                    </div>
                </div>
                
                <!-- Tableau de progression normale -->
                <table class="progress-table" id="progressTable">
                    <thead>
                        <tr>
                            <th>Action</th>
                            <th>OND1</th>
                            <th>OND2</th>
                            <th>OND3</th>
                            <th>OND4</th>
                            <th>OND5</th>
                            <th>OND6</th>
                        </tr>
                    </thead>
                    <tbody id="progressTableBody">
                        <!-- Les lignes seront g√©n√©r√©es dynamiquement -->
                    </tbody>
                </table>
                
                <!-- Vue "Reste √† faire" pour chef d'√©quipe (par onduleur) -->
                <div id="resteAFaireView" style="display: none;">
                    <div style="font-size: 13px; font-weight: 600; margin-bottom: 15px; padding: 10px; background: #f5f5f5; border: 1px solid #000;">
                        Vue Chef d'√âquipe - R√©partition du travail par onduleur
                    </div>
                    <div class="chef-equipe-container" id="chefEquipeContainer">
                        <!-- Les cartes d'onduleur seront g√©n√©r√©es dynamiquement -->
                    </div>
                </div>
                
                <div class="comparatif-note">
                    Comparatif avec un planning de ref ???
                </div>
            </div>
        </div>
        
        <!-- Dashboard Financier -->
        <div id="financial-view" class="view-section">
            <button class="back-button" id="btnBackFromFinancial">‚Üê Retour √† l'accueil</button>
            
            <div class="financial-dashboard">
                <!-- En-t√™te avec s√©lecteur de date -->
                <div class="financial-header">
                    <div class="date-selector-container">
                        <span class="date-selector-label">Date de r√©f√©rence :</span>
                        <input type="date" id="dateSelector" class="date-selector">
                    </div>
                    <div class="financial-summary">
                        <div class="financial-summary-title">Montant total facturable √† date</div>
                        <div class="financial-summary-amount" id="totalFacturable">0 ‚Ç¨</div>
                    </div>
                </div>
                
                <!-- Tableau des tranches -->
                <table class="tranches-table" id="tranchesTable">
                    <thead>
                        <tr>
                            <th>Tranche / Cat√©gorie</th>
                            <th>Montant Total (‚Ç¨)</th>
                            <th>% Avancement</th>
                            <th>Montant Facturable (‚Ç¨)</th>
                        </tr>
                    </thead>
                    <tbody id="tranchesTableBody">
                        <!-- Les lignes seront g√©n√©r√©es dynamiquement -->
                    </tbody>
                </table>
                
                <!-- Timeline mensuelle -->
                <div class="timeline-container">
                    <div class="timeline-header">Timeline d'avancement par tranche</div>
                    <div class="timeline-grid">
                        <div class="timeline-labels" id="timelineLabels">
                            <!-- G√©n√©r√© dynamiquement -->
                        </div>
                        <div>
                            <div class="timeline-bars" id="timelineBars">
                                <!-- G√©n√©r√© dynamiquement -->
                            </div>
                            <div class="timeline-months">
                                <span>Jan</span>
                                <span>F√©v</span>
                                <span>Mar</span>
                                <span>Avr</span>
                                <span>Mai</span>
                                <span>Jun</span>
                                <span>Jul</span>
                                <span>Ao√ª</span>
                                <span>Sep</span>
                                <span>Oct</span>
                                <span>Nov</span>
                                <span>D√©c</span>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Total facturable -->
                <div class="total-section">
                    <span class="total-label">TOTAL FACTURABLE √Ä DATE</span>
                    <span class="total-amount" id="totalFacturableBottom">0 ‚Ç¨</span>
                </div>
            </div>
        </div>
    </div>
    
    <script>
        // Donn√©es de d√©monstration
        const demoData = {
            forages: {
                zone1a: { cqReel: 15, cqPrevu: 35, reel: 85, prevu: 92 },
                zone1b: { cqReel: 22, cqPrevu: 40, reel: 78, prevu: 88 },
                zone1c: { cqReel: 18, cqPrevu: 38, reel: 82, prevu: 90 },
                zone1d: { cqReel: 12, cqPrevu: 32, reel: 88, prevu: 95 },
                all: { cqReel: 17, cqPrevu: 36, reel: 83, prevu: 91 }
            },
            micropieux: {
                zone1a: { cqReel: 25, cqPrevu: 45, reel: 70, prevu: 80 },
                zone1b: { cqReel: 30, cqPrevu: 50, reel: 65, prevu: 75 },
                zone1c: { cqReel: 28, cqPrevu: 48, reel: 68, prevu: 78 },
                zone1d: { cqReel: 20, cqPrevu: 42, reel: 73, prevu: 82 },
                all: { cqReel: 26, cqPrevu: 46, reel: 69, prevu: 79 }
            },
            structures: {
                zone1a: { cqReel: 40, cqPrevu: 60, reel: 75, prevu: 88 },
                zone1b: { cqReel: 45, cqPrevu: 65, reel: 70, prevu: 85 },
                zone1c: { cqReel: 42, cqPrevu: 62, reel: 73, prevu: 87 },
                zone1d: { cqReel: 38, cqPrevu: 58, reel: 78, prevu: 90 },
                all: { cqReel: 41, cqPrevu: 61, reel: 74, prevu: 88 }
            }
        };
        
        // Donn√©es de d√©monstration pour le dashboard √©lectrique
        const demoElectricalData = {
            actions: [
                {
                    name: "Tirage c√¢bles",
                    ond1: 85,
                    ond2: 92,
                    ond3: 78,
                    ond4: 95,
                    ond5: 88,
                    ond6: 90,
                    zone: "zone1",
                    sousZone: "1.1",
                    ptr: "PTR1.1-1"
                },
                {
                    name: "Raccordement",
                    ond1: 65,
                    ond2: 72,
                    ond3: 58,
                    ond4: 80,
                    ond5: 68,
                    ond6: 75,
                    zone: "zone1",
                    sousZone: "1.2",
                    ptr: "PTR1.2-1"
                },
                {
                    name: "Tests √©lectriques",
                    ond1: 45,
                    ond2: 52,
                    ond3: 38,
                    ond4: 60,
                    ond5: 48,
                    ond6: 55,
                    zone: "zone2",
                    sousZone: "2.1",
                    ptr: "PTR2.1-1"
                },
                {
                    name: "Mise en service",
                    ond1: 25,
                    ond2: 32,
                    ond3: 18,
                    ond4: 40,
                    ond5: 28,
                    ond6: 35,
                    zone: "zone1",
                    sousZone: "1.1",
                    ptr: "PTR1.1-2"
                },
                {
                    name: "Contr√¥le final",
                    ond1: 15,
                    ond2: 22,
                    ond3: 8,
                    ond4: 30,
                    ond5: 18,
                    ond6: 25,
                    zone: "zone2",
                    sousZone: "2.2",
                    ptr: "PTR2.2-1"
                }
            ]
        };
        
        // Donn√©es de d√©monstration pour le dashboard financier
        const demoFinancialData = {
            tranches: [
                {
                    name: "Tranche 1",
                    categories: [
                        { name: "MECA", amount: 450000, startMonth: 0, endMonth: 6, progress: 85 },
                        { name: "MOD", amount: 280000, startMonth: 1, endMonth: 5, progress: 92 },
                        { name: "ELEC", amount: 320000, startMonth: 2, endMonth: 7, progress: 78 }
                    ]
                },
                {
                    name: "Tranche 2",
                    categories: [
                        { name: "MECA", amount: 520000, startMonth: 3, endMonth: 9, progress: 65 },
                        { name: "MOD", amount: 310000, startMonth: 4, endMonth: 8, progress: 72 },
                        { name: "ELEC", amount: 380000, startMonth: 5, endMonth: 10, progress: 58 }
                    ]
                },
                {
                    name: "Tranche 3",
                    categories: [
                        { name: "MECA", amount: 490000, startMonth: 6, endMonth: 11, progress: 45 },
                        { name: "MOD", amount: 295000, startMonth: 7, endMonth: 11, progress: 52 },
                        { name: "ELEC", amount: 350000, startMonth: 8, endMonth: 11, progress: 38 }
                    ]
                }
            ]
        };
        
        let projectData = null; // Pour le futur branchement sur export MS Project
        let currentCategory = 'forages';
        let currentZone = 'all';
        let currentView = 'home';
        let selectedDate = new Date();
        
        // Filtres √©lectriques
        let electricalFilters = {
            zone: '',
            sousZone: '',
            ptr: ''
        };
        
        // Formater un montant en euros
        function formatAmount(amount) {
            return new Intl.NumberFormat('fr-FR', {
                minimumFractionDigits: 0,
                maximumFractionDigits: 0
            }).format(amount) + ' ‚Ç¨';
        }
        
        // Calculer le pourcentage d'avancement √† une date donn√©e
        function calculateProgressAtDate(category, date) {
            // Pour la d√©mo, on utilise le pourcentage d√©j√† d√©fini
            // Dans la vraie version, on calculerait selon la date
            const selectedMonth = date.getMonth();
            const currentMonth = new Date().getMonth();
            
            // Si la date s√©lectionn√©e est dans le futur, limiter l'avancement
            if (selectedMonth > currentMonth) {
                return Math.min(category.progress, 
                    Math.floor(category.progress * (selectedMonth / 11)));
            }
            
            return category.progress;
        }
        
        // Afficher le tableau des tranches financi√®res
        function renderFinancialTable(date) {
            const tbody = document.getElementById('tranchesTableBody');
            const data = projectData && projectData.financial 
                ? projectData.financial.tranches 
                : demoFinancialData.tranches;
            
            let html = '';
            let totalFacturable = 0;
            
            data.forEach(tranche => {
                let trancheTotalAmount = 0;
                let trancheTotalFacturable = 0;
                let trancheTotalProgress = 0;
                
                // Calculer les totaux de la tranche
                tranche.categories.forEach(category => {
                    trancheTotalAmount += category.amount;
                    const progress = calculateProgressAtDate(category, date);
                    trancheTotalFacturable += (category.amount * progress / 100);
                    trancheTotalProgress += progress;
                });
                
                const avgProgress = Math.round(trancheTotalProgress / tranche.categories.length);
                
                // Ligne principale de la tranche
                html += '<tr>';
                html += `<td class="tranche-name">${tranche.name}</td>`;
                html += `<td class="amount">${formatAmount(trancheTotalAmount)}</td>`;
                html += `<td class="percentage">${avgProgress}%</td>`;
                html += `<td class="amount">${formatAmount(trancheTotalFacturable)}</td>`;
                html += '</tr>';
                
                // Sous-lignes pour chaque cat√©gorie
                tranche.categories.forEach(category => {
                    const progress = calculateProgressAtDate(category, date);
                    const facturable = category.amount * progress / 100;
                    
                    html += '<tr>';
                    html += `<td class="sub-category">‚îî‚îÄ ${category.name}</td>`;
                    html += `<td class="amount">${formatAmount(category.amount)}</td>`;
                    html += `<td class="percentage">${progress}%</td>`;
                    html += `<td class="amount">${formatAmount(facturable)}</td>`;
                    html += '</tr>';
                });
                
                totalFacturable += trancheTotalFacturable;
            });
            
            tbody.innerHTML = html;
            
            // Mettre √† jour les montants totaux
            document.getElementById('totalFacturable').textContent = formatAmount(totalFacturable);
            document.getElementById('totalFacturableBottom').textContent = formatAmount(totalFacturable);
        }
        
        // Afficher la timeline des tranches
        function renderTimeline(date) {
            const labelsContainer = document.getElementById('timelineLabels');
            const barsContainer = document.getElementById('timelineBars');
            const data = projectData && projectData.financial 
                ? projectData.financial.tranches 
                : demoFinancialData.tranches;
            
            let labelsHtml = '';
            let barsHtml = '';
            
            data.forEach(tranche => {
                tranche.categories.forEach(category => {
                    const progress = calculateProgressAtDate(category, date);
                    const duration = category.endMonth - category.startMonth + 1;
                    const width = (duration / 12) * 100;
                    const left = (category.startMonth / 12) * 100;
                    
                    labelsHtml += `<div class="timeline-label">${tranche.name} - ${category.name}</div>`;
                    
                    barsHtml += `
                        <div class="timeline-bar-row">
                            <div class="timeline-bar" style="width: ${width}%; margin-left: ${left}%;">
                                <span class="timeline-bar-label">${progress}%</span>
                            </div>
                        </div>
                    `;
                });
            });
            
            labelsContainer.innerHTML = labelsHtml;
            barsContainer.innerHTML = barsHtml;
        }
        
        // Mettre √† jour le dashboard financier
        function updateFinancialDashboard() {
            renderFinancialTable(selectedDate);
            renderTimeline(selectedDate);
        }
        
        // Changer de vue principale
        function switchMainView(viewName) {
            currentView = viewName;
            
            // Masquer toutes les vues
            document.querySelectorAll('.view-section').forEach(section => {
                section.classList.remove('active');
            });
            
            // Afficher la vue s√©lectionn√©e
            if (viewName === 'home') {
                document.getElementById('home-view').classList.add('active');
            } else if (viewName === 'mechanical') {
                document.getElementById('mechanical-view').classList.add('active');
                // Afficher la vue principale et masquer Tranch√©es par d√©faut
                document.getElementById('mechanical-main-view').style.display = 'block';
                document.getElementById('mechanical-tranchees-view').style.display = 'none';
            } else if (viewName === 'electrical') {
                document.getElementById('electrical-view').classList.add('active');
                renderElectricalTable();
            } else if (viewName === 'financial') {
                document.getElementById('financial-view').classList.add('active');
                updateFinancialDashboard();
            }
        }
        
        // Navigation depuis la page d'accueil
        document.querySelectorAll('.dashboard-card').forEach(card => {
            card.addEventListener('click', function() {
                const dashboard = this.getAttribute('data-dashboard');
                if (dashboard === 'mechanical') {
                    switchMainView('mechanical');
                } else if (dashboard === 'electrical') {
                    switchMainView('electrical');
                } else if (dashboard === 'financial') {
                    switchMainView('financial');
                }
            });
        });
        
        // Boutons retour
        document.getElementById('btnBackFromMeca').addEventListener('click', function() {
            switchMainView('home');
        });
        
        document.getElementById('btnBackFromElec').addEventListener('click', function() {
            switchMainView('home');
        });
        
        document.getElementById('btnBackFromFinancial').addEventListener('click', function() {
            switchMainView('home');
        });
        
        // Mise √† jour des barres en fonction de la cat√©gorie et de la zone
        // Note: Cette fonction n'est plus utilis√©e avec la nouvelle vue d'avancement
        // Elle pourra √™tre r√©activ√©e si n√©cessaire pour des donn√©es dynamiques
        function updateChart(category, zone = 'all') {
            // Fonction conserv√©e pour compatibilit√© future
            // L'ancienne vue avec graphiques a √©t√© remplac√©e par la vue d'avancement
        }
        
        // Fonction pour obtenir la classe de couleur selon le pourcentage
        function getPercentageClass(percentage) {
            if (percentage >= 70) return 'high';
            if (percentage >= 40) return 'medium';
            return 'low';
        }
        
        // Afficher le tableau de progression √©lectrique
        function renderElectricalTable(filterAction = null) {
            const tbody = document.getElementById('progressTableBody');
            const data = projectData && projectData.electrical 
                ? projectData.electrical.actions 
                : demoElectricalData.actions;
            
            let filteredData = data;
            
            // Filtrer par action si s√©lectionn√©e
            if (filterAction && filterAction !== '') {
                // Extraire le num√©ro d'action (ex: "action1" -> 1)
                const actionNumber = parseInt(filterAction.replace('action', ''));
                if (!isNaN(actionNumber) && actionNumber > 0 && actionNumber <= data.length) {
                    filteredData = [data[actionNumber - 1]];
                }
            }
            
            // Appliquer les filtres g√©ographiques
            filteredData = filteredData.filter(action => {
                let match = true;
                
                if (electricalFilters.zone && action.zone !== electricalFilters.zone) {
                    match = false;
                }
                
                if (electricalFilters.sousZone && action.sousZone !== electricalFilters.sousZone) {
                    match = false;
                }
                
                if (electricalFilters.ptr && action.ptr !== electricalFilters.ptr) {
                    match = false;
                }
                
                return match;
            });
            
            let html = '';
            filteredData.forEach(action => {
                html += '<tr>';
                html += `<td class="action-name">${action.name}</td>`;
                html += `<td class="percentage ${getPercentageClass(action.ond1)}">${action.ond1}%</td>`;
                html += `<td class="percentage ${getPercentageClass(action.ond2)}">${action.ond2}%</td>`;
                html += `<td class="percentage ${getPercentageClass(action.ond3)}">${action.ond3}%</td>`;
                html += `<td class="percentage ${getPercentageClass(action.ond4)}">${action.ond4}%</td>`;
                html += `<td class="percentage ${getPercentageClass(action.ond5)}">${action.ond5}%</td>`;
                html += `<td class="percentage ${getPercentageClass(action.ond6)}">${action.ond6}%</td>`;
                html += '</tr>';
            });
            
            tbody.innerHTML = html;
        }
        
        // Afficher la vue "Reste √† faire" par onduleur (mode chef d'√©quipe)
        function renderResteAFaireView() {
            const container = document.getElementById('chefEquipeContainer');
            const data = projectData && projectData.electrical 
                ? projectData.electrical.actions 
                : demoElectricalData.actions;
            
            // Liste des onduleurs
            const onduleurs = ['ond1', 'ond2', 'ond3', 'ond4', 'ond5', 'ond6'];
            
            let html = '';
            
            // Cr√©er une carte pour chaque onduleur
            onduleurs.forEach((ond, index) => {
                const ondNum = index + 1;
                html += `<div class="onduleur-card">`;
                html += `<div class="onduleur-card-header">OND${ondNum}</div>`;
                
                // Pour chaque action, afficher l'avancement avec barre jaune
                data.forEach(action => {
                    const avancement = action[ond];
                    
                    html += `<div class="onduleur-action-row">`;
                    html += `<div class="onduleur-action-label">${action.name}</div>`;
                    html += `<div class="onduleur-bar-container">`;
                    html += `<div class="onduleur-bar" style="width: ${avancement}%;"></div>`;
                    html += `</div>`;
                    html += `<div class="onduleur-percentage">${avancement}%</div>`;
                    html += `</div>`;
                });
                
                html += `</div>`;
            });
            
            container.innerHTML = html;
        }
        
        // Initialiser le graphique S-Curve
        function initScurveChart() {
            const ctx = document.getElementById('scurveChart').getContext('2d');
            
            // Donn√©es de d√©monstration - Semaines S1 √† S20
            const weeks = ['S1', 'S2', 'S3', 'S4', 'S5', 'S6', 'S7', 'S8', 'S9', 'S10', 
                          'S11', 'S12', 'S13', 'S14', 'S15', 'S16', 'S17', 'S18', 'S19', 'S20'];
            
            // Valeurs r√©elles (barres bleues)
            const reel = [5, 8, 12, 15, 18, 22, 25, 30, 35, 38, 42, 45, 48, 50, 52, 54, 56, 58, 60, 62];
            
            // Valeurs planifi√©es (barres rouges)
            const planifie = [6, 10, 14, 18, 22, 26, 30, 34, 38, 42, 46, 50, 54, 58, 62, 66, 68, 70, 72, 74];
            
            // Cumul r√©el (courbe bleue)
            const cumulReel = [];
            let sumReel = 0;
            reel.forEach(val => {
                sumReel += val;
                cumulReel.push(sumReel);
            });
            
            // Cumul planifi√© (courbe rouge)
            const cumulPlanifie = [];
            let sumPlanifie = 0;
            planifie.forEach(val => {
                sumPlanifie += val;
                cumulPlanifie.push(sumPlanifie);
            });
            
            window.scurveChartInstance = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: weeks,
                    datasets: [
                        {
                            label: 'Cumul√© r√©el',
                            data: cumulReel,
                            type: 'line',
                            borderColor: '#2563eb',
                            backgroundColor: 'rgba(37, 99, 235, 0.1)',
                            borderWidth: 3,
                            tension: 0.4,
                            fill: false,
                            pointRadius: 4,
                            pointBackgroundColor: '#2563eb',
                            yAxisID: 'y1',
                            order: 1
                        },
                        {
                            label: 'Cumul√© planifi√©',
                            data: cumulPlanifie,
                            type: 'line',
                            borderColor: '#dc2626',
                            backgroundColor: 'rgba(220, 38, 38, 0.1)',
                            borderWidth: 3,
                            borderDash: [8, 4],
                            tension: 0.4,
                            fill: false,
                            pointRadius: 4,
                            pointBackgroundColor: '#dc2626',
                            yAxisID: 'y1',
                            order: 2
                        },
                        {
                            label: 'R√©el',
                            data: reel,
                            backgroundColor: '#3b82f6',
                            borderColor: '#1e40af',
                            borderWidth: 1,
                            yAxisID: 'y',
                            order: 3
                        },
                        {
                            label: 'Planifi√©',
                            data: planifie,
                            backgroundColor: '#ef4444',
                            borderColor: '#b91c1c',
                            borderWidth: 1,
                            yAxisID: 'y',
                            order: 4
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: false
                        },
                        tooltip: {
                            mode: 'index',
                            intersect: false,
                            callbacks: {
                                label: function(context) {
                                    let label = context.dataset.label || '';
                                    if (label) {
                                        label += ': ';
                                    }
                                    if (context.parsed.y !== null) {
                                        if (context.dataset.type === 'line') {
                                            label += context.parsed.y.toFixed(0) + '%';
                                        } else {
                                            label += context.parsed.y.toFixed(0) + '%';
                                        }
                                    }
                                    return label;
                                }
                            }
                        }
                    },
                    scales: {
                        x: {
                            grid: {
                                display: true,
                                color: '#e5e7eb'
                            },
                            ticks: {
                                font: {
                                    size: 10
                                }
                            }
                        },
                        y: {
                            type: 'linear',
                            position: 'left',
                            title: {
                                display: true,
                                text: 'Avancement par semaine (%)',
                                font: {
                                    size: 11,
                                    weight: 'bold'
                                }
                            },
                            min: 0,
                            max: 80,
                            ticks: {
                                callback: function(value) {
                                    return value + '%';
                                },
                                font: {
                                    size: 10
                                }
                            },
                            grid: {
                                color: '#e5e7eb'
                            }
                        },
                        y1: {
                            type: 'linear',
                            position: 'right',
                            title: {
                                display: true,
                                text: 'Avancement cumul√© (%)',
                                font: {
                                    size: 11,
                                    weight: 'bold'
                                }
                            },
                            min: 0,
                            max: 1600,
                            ticks: {
                                callback: function(value) {
                                    return value + '%';
                                },
                                font: {
                                    size: 10
                                }
                            },
                            grid: {
                                drawOnChartArea: false
                            }
                        }
                    },
                    interaction: {
                        mode: 'index',
                        intersect: false
                    }
                }
            });
        }
        
        // Gestion des clics sur les onglets de cat√©gorie (Dashboard M√©canique)
        document.querySelectorAll('.tab-button[data-category]').forEach(button => {
            button.addEventListener('click', function() {
                const view = this.getAttribute('data-view');
                
                // Si on clique sur un bouton de la vue principale
                if (view === 'main') {
                    // Retirer la classe active de tous les boutons de cat√©gorie
                    document.querySelectorAll('.tab-button[data-category]').forEach(btn => {
                        btn.classList.remove('active');
                    });
                    
                    // Ajouter la classe active au bouton cliqu√©
                    this.classList.add('active');
                    
                    // R√©cup√©rer la cat√©gorie
                    currentCategory = this.getAttribute('data-category');
                    
                    // Note: Les donn√©es par cat√©gorie pourront √™tre int√©gr√©es ult√©rieurement
                }
            });
        });
        
        // Gestion du clic sur le bouton Tranch√©es
        document.querySelectorAll('.tab-button[data-view="tranchees"]').forEach(button => {
            button.addEventListener('click', function() {
                // Retirer la classe active de tous les boutons
                document.querySelectorAll('.tab-button[data-category], .tab-button[data-view="tranchees"], .tab-button[data-view="scurve"]').forEach(btn => {
                    btn.classList.remove('active');
                });
                
                // Ajouter la classe active au bouton Tranch√©es
                this.classList.add('active');
                
                // Masquer la vue principale et le menu des zones
                document.getElementById('mechanical-main-view').style.display = 'none';
                document.getElementById('zoneSelect').parentElement.style.display = 'none';
                
                // Masquer la vue S-Curve
                document.getElementById('mechanical-scurve-view').style.display = 'none';
                
                // Afficher la vue Tranch√©es
                document.getElementById('mechanical-tranchees-view').style.display = 'block';
            });
        });
        
        // Gestion du clic sur le bouton S-Curve
        document.querySelectorAll('.tab-button[data-view="scurve"]').forEach(button => {
            button.addEventListener('click', function() {
                // Retirer la classe active de tous les boutons
                document.querySelectorAll('.tab-button[data-category], .tab-button[data-view="tranchees"], .tab-button[data-view="scurve"]').forEach(btn => {
                    btn.classList.remove('active');
                });
                
                // Ajouter la classe active au bouton S-Curve
                this.classList.add('active');
                
                // Masquer la vue principale et le menu des zones
                document.getElementById('mechanical-main-view').style.display = 'none';
                document.getElementById('zoneSelect').parentElement.style.display = 'none';
                
                // Masquer la vue Tranch√©es
                document.getElementById('mechanical-tranchees-view').style.display = 'none';
                
                // Afficher la vue S-Curve
                document.getElementById('mechanical-scurve-view').style.display = 'block';
                
                // Initialiser le graphique S-Curve si pas d√©j√† fait
                if (!window.scurveChartInstance) {
                    initScurveChart();
                }
            });
        });
        
        // Gestion du retour √† la vue principale depuis Tranch√©es
        document.querySelectorAll('.tab-button[data-view="main"]').forEach(button => {
            button.addEventListener('click', function() {
                // Afficher la vue principale et le menu des zones
                document.getElementById('mechanical-main-view').style.display = 'block';
                document.getElementById('zoneSelect').parentElement.style.display = 'flex';
                
                // Masquer la vue Tranch√©es
                document.getElementById('mechanical-tranchees-view').style.display = 'none';
                
                // Masquer la vue S-Curve
                document.getElementById('mechanical-scurve-view').style.display = 'none';
            });
        });
        
        // Gestion du changement de zone
        document.getElementById('zoneSelect').addEventListener('change', function() {
            const zone = this.value;
            console.log('Zone s√©lectionn√©e:', zone);
            
            // Mettre √† jour la zone actuelle
            currentZone = zone || 'all';
            
            // Note: La gestion par zone pourra √™tre int√©gr√©e ult√©rieurement
        });
        
        // Gestion du bouton "Tout voir"
        document.getElementById('btnViewAll').addEventListener('click', function() {
            // Afficher le tableau de progression normal
            document.getElementById('progressTable').style.display = 'table';
            document.getElementById('resteAFaireView').style.display = 'none';
            document.getElementById('selectAction').disabled = false;
            
            document.getElementById('selectAction').value = '';
            renderElectricalTable();
        });
        
        // Gestion du bouton "Reste √† faire"
        document.getElementById('btnResteAFaire').addEventListener('click', function() {
            // Afficher la vue "Reste √† faire" par onduleur
            document.getElementById('progressTable').style.display = 'none';
            document.getElementById('resteAFaireView').style.display = 'block';
            document.getElementById('selectAction').disabled = true;
            
            renderResteAFaireView();
        });
        
        // Gestion du changement de s√©lection d'action √©lectrique
        document.getElementById('selectAction').addEventListener('change', function() {
            const action = this.value;
            renderElectricalTable(action);
        });
        
        // Gestion des filtres g√©ographiques
        document.getElementById('filterZone').addEventListener('change', function() {
            electricalFilters.zone = this.value;
            renderElectricalTable(document.getElementById('selectAction').value);
        });
        
        document.getElementById('filterSousZone').addEventListener('change', function() {
            electricalFilters.sousZone = this.value;
            renderElectricalTable(document.getElementById('selectAction').value);
        });
        
        document.getElementById('filterPTR').addEventListener('change', function() {
            electricalFilters.ptr = this.value;
            renderElectricalTable(document.getElementById('selectAction').value);
        });
        
        // Gestion du bouton de r√©initialisation des filtres
        document.getElementById('btnResetFilters').addEventListener('click', function() {
            electricalFilters.zone = '';
            electricalFilters.sousZone = '';
            electricalFilters.ptr = '';
            
            document.getElementById('filterZone').value = '';
            document.getElementById('filterSousZone').value = '';
            document.getElementById('filterPTR').value = '';
            
            renderElectricalTable(document.getElementById('selectAction').value);
        });
        
        // Fonction d'export CSV
        function exportElectricalToCSV() {
            const data = projectData && projectData.electrical 
                ? projectData.electrical.actions 
                : demoElectricalData.actions;
            
            // Appliquer les filtres
            let filteredData = data.filter(action => {
                let match = true;
                
                if (electricalFilters.zone && action.zone !== electricalFilters.zone) {
                    match = false;
                }
                
                if (electricalFilters.sousZone && action.sousZone !== electricalFilters.sousZone) {
                    match = false;
                }
                
                if (electricalFilters.ptr && action.ptr !== electricalFilters.ptr) {
                    match = false;
                }
                
                return match;
            });
            
            // Cr√©er le contenu CSV
            let csvContent = "Action,OND1,OND2,OND3,OND4,OND5,OND6,Zone,Sous-zone,PTR\n";
            
            filteredData.forEach(action => {
                const row = [
                    action.name,
                    action.ond1 + '%',
                    action.ond2 + '%',
                    action.ond3 + '%',
                    action.ond4 + '%',
                    action.ond5 + '%',
                    action.ond6 + '%',
                    action.zone || '',
                    action.sousZone || '',
                    action.ptr || ''
                ].join(',');
                csvContent += row + "\n";
            });
            
            // Cr√©er le fichier et le t√©l√©charger
            const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
            const link = document.createElement('a');
            const url = URL.createObjectURL(blob);
            
            link.setAttribute('href', url);
            link.setAttribute('download', 'export_electrique_' + new Date().toISOString().slice(0,10) + '.csv');
            link.style.visibility = 'hidden';
            
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        }
        
        // Gestion du bouton d'export
        document.getElementById('btnExportElec').addEventListener('click', function() {
            exportElectricalToCSV();
        });
        
        // Gestion du changement de date
        document.getElementById('dateSelector').addEventListener('change', function() {
            selectedDate = new Date(this.value);
            updateFinancialDashboard();
        });
        
        // Fonction pour charger les donn√©es depuis projectData (export MS Project)
        function loadProjectData(data) {
            projectData = data;
            
            if (currentView === 'mechanical') {
                // Note: L'int√©gration des donn√©es pourra √™tre ajout√©e ici
                // pour mettre √† jour dynamiquement les barres d'avancement
            } else if (currentView === 'electrical') {
                renderElectricalTable();
            } else if (currentView === 'financial') {
                updateFinancialDashboard();
            }
        }
        
        // Initialisation
        document.addEventListener('DOMContentLoaded', function() {
            // Par d√©faut, on est sur la page d'accueil
            switchMainView('home');
            
            // Initialiser la date du s√©lecteur √† aujourd'hui
            const today = new Date();
            document.getElementById('dateSelector').valueAsDate = today;
            selectedDate = today;
        });
        
        // Exposition de la fonction pour le chargement futur
        window.loadProjectData = loadProjectData;
    </script>
</body>
</html>
