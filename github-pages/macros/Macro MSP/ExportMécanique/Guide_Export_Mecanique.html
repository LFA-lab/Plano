<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Guide Export M√©canique - OMEXOM</title>
    <style>
        /* CSS inline pour un fichier autonome */
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Arial, sans-serif;
            line-height: 1.6;
            max-width: 1000px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f8f9fa;
            color: #333;
        }

        .header {
            background: linear-gradient(135deg, #0066cc, #004d99);
            color: white;
            padding: 30px;
            border-radius: 8px;
            margin-bottom: 30px;
            text-align: center;
        }

        .header h1 {
            margin: 0 0 10px 0;
            font-size: 2.2em;
            font-weight: 300;
        }

        .header .subtitle {
            font-size: 1.1em;
            opacity: 0.9;
        }

        .client-logo {
            background: white;
            color: #0066cc;
            font-weight: bold;
            font-size: 1.3em;
            padding: 8px 16px;
            border-radius: 4px;
            display: inline-block;
            margin-bottom: 20px;
        }

        .summary {
            background: #e8f4fd;
            border-left: 4px solid #0066cc;
            padding: 20px;
            margin-bottom: 30px;
            border-radius: 0 8px 8px 0;
        }

        .summary h2 {
            margin-top: 0;
            color: #004d99;
        }

        .toc {
            background: white;
            border: 1px solid #ddd;
            border-radius: 8px;
            padding: 25px;
            margin-bottom: 30px;
        }

        .toc h2 {
            margin-top: 0;
            color: #333;
            border-bottom: 2px solid #0066cc;
            padding-bottom: 10px;
        }

        .toc ul {
            list-style-type: none;
            padding-left: 0;
        }

        .toc li {
            margin: 8px 0;
        }

        .toc a {
            color: #0066cc;
            text-decoration: none;
            font-weight: 500;
            padding: 5px 0;
            display: block;
        }

        .toc a:hover {
            color: #004d99;
            text-decoration: underline;
        }

        .step {
            background: white;
            border: 1px solid #ddd;
            border-radius: 8px;
            margin-bottom: 30px;
            overflow: hidden;
        }

        .step-header {
            background: #0066cc;
            color: white;
            padding: 15px 25px;
            font-size: 1.3em;
            font-weight: 600;
        }

        .step-content {
            padding: 25px;
        }

        .click-action {
            background: #f0f8ff;
            border-left: 3px solid #0066cc;
            padding: 12px 15px;
            margin: 10px 0;
            border-radius: 0 4px 4px 0;
        }

        .click-action strong {
            color: #004d99;
        }

        .attention {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            border-radius: 6px;
            padding: 15px;
            margin: 15px 0;
        }

        .attention::before {
            content: "‚ö†Ô∏è Attention : ";
            font-weight: bold;
            color: #856404;
        }

        .tip {
            background: #d4edda;
            border: 1px solid #c3e6cb;
            border-radius: 6px;
            padding: 15px;
            margin: 15px 0;
        }

        .tip::before {
            content: "üí° Astuce : ";
            font-weight: bold;
            color: #155724;
        }

        .capture-placeholder {
            display: none;
        }

        .troubleshoot {
            background: #f8d7da;
            border: 1px solid #f5c6cb;
            border-radius: 8px;
            margin-bottom: 30px;
            overflow: hidden;
        }

        .troubleshoot-header {
            background: #dc3545;
            color: white;
            padding: 15px 25px;
            font-size: 1.3em;
            font-weight: 600;
        }

        .troubleshoot-content {
            padding: 25px;
        }

        .problem {
            background: white;
            border-left: 4px solid #dc3545;
            padding: 15px;
            margin: 15px 0;
            border-radius: 0 6px 6px 0;
        }

        .problem-title {
            font-weight: bold;
            color: #721c24;
            margin-bottom: 8px;
        }

        .solution {
            color: #155724;
            margin-top: 8px;
        }

        .solution::before {
            content: "‚Üí Solution : ";
            font-weight: bold;
        }

        .faq {
            background: white;
            border: 1px solid #ddd;
            border-radius: 8px;
            margin-bottom: 30px;
            overflow: hidden;
        }

        .faq-header {
            background: #28a745;
            color: white;
            padding: 15px 25px;
            font-size: 1.3em;
            font-weight: 600;
        }

        .faq-content {
            padding: 25px;
        }

        .faq-item {
            margin: 20px 0;
            padding-bottom: 15px;
            border-bottom: 1px solid #eee;
        }

        .faq-item:last-child {
            border-bottom: none;
        }

        .faq-question {
            font-weight: bold;
            color: #28a745;
            margin-bottom: 8px;
        }

        .back-to-top {
            text-align: right;
            margin: 20px 0;
        }

        .back-to-top a {
            color: #0066cc;
            text-decoration: none;
            font-size: 0.9em;
        }

        .back-to-top a:hover {
            text-decoration: underline;
        }

        .output-example {
            background: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 6px;
            padding: 15px;
            margin: 15px 0;
            font-family: monospace;
        }

        .excel-tabs {
            display: flex;
            gap: 10px;
            margin: 15px 0;
        }

        .excel-tab {
            background: #e9ecef;
            border: 1px solid #ced4da;
            border-radius: 4px 4px 0 0;
            padding: 8px 15px;
            font-weight: bold;
            color: #495057;
        }

        .excel-tab.active {
            background: white;
            border-bottom: 1px solid white;
            color: #0066cc;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin: 15px 0;
        }

        th, td {
            border: 1px solid #dee2e6;
            padding: 8px 12px;
            text-align: left;
        }

        th {
            background: #f8f9fa;
            font-weight: bold;
        }

        .text-center {
            text-align: center;
        }

        ol {
            counter-reset: step-counter;
            list-style-type: none;
            padding-left: 0;
        }

        ol > li {
            counter-increment: step-counter;
            margin: 10px 0;
        }

        ol > li::before {
            content: counter(step-counter) ". ";
            font-weight: bold;
            color: #0066cc;
        }
    </style>
</head>
<body>
    <div class="header">
        <div class="client-logo">OMEXOM</div>
        <h1>Exporter le suivi m√©canique vers Excel</h1>
        <div class="subtitle">Guide clic par clic</div>
    </div>

    <div class="summary">
        <h2>üéØ Objectif</h2>
        <p><strong>√Ä la fin de ce guide, vous aurez :</strong></p>
        <ul>
            <li>Un fichier Excel automatiquement g√©n√©r√© dans vos T√©l√©chargements</li>
            <li><strong>Onglet 1 "R√©capitulatif" :</strong> totaux Pr√©vu / R√©alis√© / % par ressource m√©canique</li>
            <li><strong>Onglet 2 "Donn√©es d√©taill√©es" :</strong> √©volution jour par jour (Qt√©, R√©el, Jour, %)</li>
        </ul>
        <p><em>Dur√©e : 5 minutes pour l'installation, puis 30 secondes par export.</em></p>
    </div>

    <div class="toc">
        <h2>üìã Sommaire</h2>
        <ul>
            <li><a href="#etape1">√âtape 1 ‚Äî Importer la macro dans MS Project</a></li>
            <li><a href="#etape2">√âtape 2 ‚Äî Activer les macros (Trust Center)</a></li>
            <li><a href="#etape3">√âtape 3 ‚Äî Ajouter le bouton dans le Ruban</a></li>
            <li><a href="#etape4">√âtape 4 ‚Äî Lancer l'export et r√©cup√©rer l'Excel</a></li>
            <li><a href="#depannage">üîß D√©pannage (probl√®mes fr√©quents)</a></li>
            <li><a href="#faq">‚ùì FAQ rapide</a></li>
        </ul>
    </div>

    <div class="step" id="etape1">
        <div class="step-header">√âtape 1 ‚Äî Importer la macro dans MS Project</div>
        <div class="step-content">
            <p>Cette √©tape installe le code de la macro dans votre fichier MS Project.</p>
            
            <ol>
                <li>
                    <div class="click-action">
                        <strong>clic ‚Üí</strong> Ouvrez Microsoft Project et votre planning (.MPP)
                    </div>
                </li>
                
                <li>
                    <div class="click-action">
                        <strong>clic ‚Üí</strong> Appuyez sur <code>Alt+F11</code> pour ouvrir l'√©diteur VBA
                    </div>
                </li>
                
                <li>
                    <div class="click-action">
                        <strong>clic ‚Üí</strong> Fichier > Importer un fichier...
                    </div>
                </li>
                
                <li>
                    <div class="click-action">
                        <strong>clic ‚Üí</strong> S√©lectionnez le fichier <code>exportm√©canique.bas</code>
                    </div>
                </li>
                
                <li>
                    <div class="click-action">
                        <strong>clic ‚Üí</strong> Fichier > Enregistrer le projet (ou <code>Ctrl+S</code>)
                    </div>
                </li>
            </ol>

            <div class="attention">
                Si un message "D√©claration existante dans la port√©e en cours" appara√Æt, consultez la section <a href="#depannage">D√©pannage</a>.
            </div>
        </div>
        <div class="back-to-top"><a href="#top">‚Ü• Haut de page</a></div>
    </div>

    <div class="step" id="etape2">
        <div class="step-header">√âtape 2 ‚Äî Activer les macros (Trust Center)</div>
        <div class="step-content">
            <p>Autorisez MS Project √† ex√©cuter des macros.</p>
            
            <ol>
                <li>
                    <div class="click-action">
                        <strong>clic ‚Üí</strong> Fichier > Options
                    </div>
                </li>
                
                <li>
                    <div class="click-action">
                        <strong>clic ‚Üí</strong> Centre de gestion de la confidentialit√© > Param√®tres du Centre de gestion de la confidentialit√©...
                    </div>
                </li>
                
                <li>
                    <div class="click-action">
                        <strong>clic ‚Üí</strong> Param√®tres des macros (menu de gauche)
                    </div>
                </li>
                
                <li>
                    <div class="click-action">
                        <strong>clic ‚Üí</strong> "Activer toutes les macros"
                    </div>
                </li>
                
                <li>
                    <div class="click-action">
                        <strong>clic ‚Üí</strong> Cochez "Faire confiance √† l'acc√®s au mod√®le d'objet du projet VBA"
                    </div>
                </li>
                
                <li>
                    <div class="click-action">
                        <strong>clic ‚Üí</strong> OK puis OK pour fermer
                    </div>
                </li>
                
                <li>
                    <div class="click-action">
                        <strong>clic ‚Üí</strong> Red√©marrez MS Project si demand√©
                    </div>
                </li>
            </ol>

            <div class="tip">
                Vous pourrez revenir √† un niveau de s√©curit√© plus strict apr√®s vos exports.
            </div>
        </div>
        <div class="back-to-top"><a href="#top">‚Ü• Haut de page</a></div>
    </div>

    <div class="step" id="etape3">
        <div class="step-header">√âtape 3 ‚Äî Ajouter le bouton dans le Ruban</div>
        <div class="step-content">
            <p>Cr√©ez un bouton facilement accessible pour lancer l'export.</p>
            
            <ol>
                <li>
                    <div class="click-action">
                        <strong>clic ‚Üí</strong> Fichier > Options > Personnaliser le ruban
                    </div>
                </li>
                
                <li>
                    <div class="click-action">
                        <strong>clic ‚Üí</strong> "Choisir les commandes dans" > "Macros"
                    </div>
                </li>
                
                <li>
                    <div class="click-action">
                        <strong>clic ‚Üí</strong> S√©lectionnez <code>ExportMeca_Bouton</code> dans la liste
                    </div>
                </li>
                
                <li>
                    <div class="click-action">
                        <strong>clic ‚Üí</strong> Partie droite : s√©lectionnez l'onglet "Affichage"
                    </div>
                </li>
                
                <li>
                    <div class="click-action">
                        <strong>clic ‚Üí</strong> Clic droit sur "Affichage" > Nouveau groupe... > nommez "Exports"
                    </div>
                </li>
                
                <li>
                    <div class="click-action">
                        <strong>clic ‚Üí</strong> S√©lectionnez "Exports" > cliquez "Ajouter >>"
                    </div>
                </li>
                
                <li>
                    <div class="click-action">
                        <strong>clic ‚Üí</strong> Renommez le bouton : "Export M√©canique" > OK
                    </div>
                </li>
            </ol>

            <div class="tip">
                Le bouton appara√Æt maintenant dans Affichage > Exports > "Export M√©canique".
            </div>
        </div>
        <div class="back-to-top"><a href="#top">‚Ü• Haut de page</a></div>
    </div>

    <div class="step" id="etape4">
        <div class="step-header">√âtape 4 ‚Äî Lancer l'export et r√©cup√©rer l'Excel</div>
        <div class="step-content">
            <p>L'export se fait maintenant en un clic !</p>
            
            <ol>
                <li>
                    <div class="click-action">
                        <strong>clic ‚Üí</strong> Ruban : Affichage > Exports > "Export M√©canique"
                    </div>
                </li>
                
                <li>
                    <div class="click-action">
                        <strong>Attendez...</strong> Traitement des donn√©es (quelques secondes)
                    </div>
                </li>
                
                <li>
                    <div class="click-action">
                        <strong>Confirmation ‚Üí</strong> Une fen√™tre confirme la cr√©ation du fichier
                    </div>
                </li>
            </ol>

            <h3>üìÅ Le fichier Excel</h3>
            <div class="output-example">
                <strong>Emplacement :</strong> Dossier T√©l√©chargements<br>
                <strong>Nom :</strong> Export_Mecanique_Complet_YYYYMMDD_HHMMSS.xlsx
            </div>

            <h3>üìä Contenu : 2 onglets</h3>
            
            <h4>Onglet 1 : R√©capitulatif</h4>
            <p>Tableau simple : Ressource | Pr√©vu | R√©alis√© | % + Total g√©n√©ral</p>
            
            <h4>Onglet 2 : Donn√©es d√©taill√©es</h4>
            <p><strong>Structure :</strong> Date + pour chaque ressource : Qt√© | R√©el | Jour | %</p>
            <ul>
                <li><strong>Qt√© :</strong> Travail total pr√©vu</li>
                <li><strong>R√©el :</strong> Cumul r√©alis√© √† cette date</li>
                <li><strong>Jour :</strong> Travail fait ce jour-l√†</li>
                <li><strong>% :</strong> Avancement (R√©el/Qt√© √ó 100)</li>
            </ul>

            <div class="tip">
                Excel s'ouvre automatiquement avec le fichier. L'explorateur se positionne sur le fichier.
            </div>
        </div>
        <div class="back-to-top"><a href="#top">‚Ü• Haut de page</a></div>
    </div>

    <div class="troubleshoot" id="depannage">
        <div class="troubleshoot-header">üîß D√©pannage (probl√®mes fr√©quents)</div>
        <div class="troubleshoot-content">
            
            <div class="problem">
                <div class="problem-title">"Sub ou Function non d√©finie"</div>
                <div class="solution">Recompilez : D√©bogage > Compiler le projet VBA. Si l'erreur persiste, toutes les d√©clarations API sont dans le fichier .bas principal.</div>
            </div>

            <div class="problem">
                <div class="problem-title">"D√©claration existante"</div>
                <div class="solution">Supprimez les doublons dans l'√©diteur VBA. Gardez une seule copie de chaque fonction/d√©claration.</div>
            </div>

            <div class="problem">
                <div class="problem-title">Export vide / pas de dates</div>
                <div class="solution">Aucune donn√©e r√©elle trouv√©e. Saisissez des heures r√©elles dans vos t√¢ches, puis relancez.</div>
            </div>

            <div class="problem">
                <div class="problem-title">Fichier Excel introuvable</div>
                <div class="solution">Ouvrez l'Explorateur > "T√©l√©chargements" dans le panneau gauche. Le fichier y sera visible.</div>
            </div>

            <div class="problem">
                <div class="problem-title">Bouton n'appara√Æt pas</div>
                <div class="solution">Refaites l'√âtape 3. V√©rifiez que vous trouvez bien "ExportMeca_Bouton" dans la liste des macros.</div>
            </div>

            <div class="problem">
                <div class="problem-title">Aucune ressource trouv√©e</div>
                <div class="solution">V√©rifiez que vos ressources ont "M√©canique" dans le champ "Groupe" (attention √† l'orthographe).</div>
            </div>

        </div>
        <div class="back-to-top"><a href="#top">‚Ü• Haut de page</a></div>
    </div>

    <div class="faq" id="faq">
        <div class="faq-header">‚ùì FAQ rapide</div>
        <div class="faq-content">
            
            <div class="faq-item">
                <div class="faq-question">Puis-je changer l'onglet du bouton ?</div>
                <p>Oui : Fichier > Options > Personnaliser le ruban > d√©placez le groupe "Exports" o√π vous voulez.</p>
            </div>

            <div class="faq-item">
                <div class="faq-question">Format des nombres ?</div>
                <p>La macro applique automatiquement le format entier (pas de d√©cimales) pour Qt√©, R√©el, Jour.</p>
            </div>

            <div class="faq-item">
                <div class="faq-question">Ordre des ressources ?</div>
                <p>Tri par plus petit num√©ro de t√¢che assign√©e. Les ressources sans assignation sont en fin.</p>
            </div>

            <div class="faq-item">
                <div class="faq-question">Excel s'ouvre automatiquement ?</div>
                <p>Oui, avec le fichier cr√©√©. L'explorateur se positionne aussi sur le fichier.</p>
            </div>

        </div>
        <div class="back-to-top"><a href="#top">‚Ü• Haut de page</a></div>
    </div>

    <footer style="text-align: center; margin-top: 50px; padding: 20px; border-top: 1px solid #ddd; color: #666;">
        <p><strong>OMEXOM</strong> - Guide Export M√©canique</p>
        <p><em>Version 1.0 - Ao√ªt 2025</em></p>
    </footer>

</body>
</html>
