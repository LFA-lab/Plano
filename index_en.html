<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Onboarding Journey </title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="container">
        <header>
            <div class="language-selector">
                <a href="index.html" class="language-btn">
                    üá´üá∑ Fran√ßais
                </a>
                <span class="language-current">
                    üá¨üáß English
                </span>
                <a href="index_inde.html" class="language-btn">
                    üáÆüá≥ ‡§π‡§ø‡§Ç‡§¶‡•Ä
                </a>
            </div>
            <h1>Onboarding Journey</h1>
            <p>Integration guide for new employees</p>
        </header>

        <div class="role-switch" role="group" aria-label="Role selector">
            <span class="role-label">I am:</span>
            <button type="button" class="role-btn" data-role-select="both" aria-pressed="true">All</button>
            <button type="button" class="role-btn" data-role-select="manager" aria-pressed="false">Manager</button>
            <button type="button" class="role-btn" data-role-select="apprenant" aria-pressed="false">Learner</button>
        </div>
        <main class="main-content">
            <section class="week-section">
                <h2>Week 1 ‚Äì Configuration and pre-project training</h2>
                
                <div class="subsection">
                    <h3>Configuration</h3>
                    <div class="task-list">
                        <div class="task-item" data-role="both" data-duration="5‚Äì10 min" data-outcome="Request sent">
                            <h4>Sitemark account creation</h4>
                            <p>Request account creation from Antoine LE FRAPPER</p>
                            <a href="mailto:antoine.lefrapper@omexom.com?subject=Sitemark account creation request" class="btn btn-primary">
                                Send email
                            </a>
                        </div>
                        
                        <div class="task-item" data-role="apprenant" data-duration="10‚Äì15 min" data-outcome="App installed and signed in">
                            <h4>Sitemark mobile app installation</h4>
                            <p>Install the application on your smartphone for field data collection</p>
                            <div class="app-links">
                                <a href="https://play.google.com/store/apps/details?id=com.sitemark.fieldlink&pcampaignid=web_share" target="_blank" rel="noopener noreferrer" class="btn btn-secondary">
                                    Android
                                </a>
                                <a href="https://apps.apple.com/fr/app/sitemark-field-link/id6451259304" target="_blank" rel="noopener noreferrer" class="btn btn-secondary">
                                    iOS
                                </a>
                                <a href="https://app.sitemark.com/sites" target="_blank" rel="noopener noreferrer" class="btn btn-secondary">
                                    Website
                                </a>
                            </div>
                        </div>
                        
                        <div class="task-item" data-role="manager" data-duration="5‚Äì10 min" data-outcome="Install request submitted">
                            <h4>MS Project installation on your PC</h4>
                            <p>Project management software required for planning phases and construction progress</p>
                            <span class="info-badge">Contact Omexom IT support</span>
                        </div>
                    </div>
                </div>

                <div class="subsection">
                    <h3>New Arrivals Training</h3>
                    <div class="task-list">                        
                        <div class="task-item" data-role="apprenant" data-duration="20‚Äì30 min" data-outcome="Module completed">
                            <h4>Teams Planner Training</h4>
                            <p>Collaborative planning tool used at project start</p>
                            <a href="https://pontiva.thinkific.com/courses/PlanificateurTeams" target="_blank" rel="noopener noreferrer" class="btn btn-secondary">
                                Start training
                            </a>
                            <div class="planb" data-planb="thinkific">
                                <button class="planb-toggle" aria-expanded="true">Plan B ¬∑ Thinkific</button>
                                <div class="planb-content">
                                    If the redirect fails: sign in to Thinkific ‚Üí open ‚ÄúMy Courses‚Äù ‚Üí search for Teams Planner / Sitemark ‚Üí Resume.
                                </div>
                            </div>
                        </div>
                        
                        <div class="task-item" data-role="apprenant" data-duration="20‚Äì30 min" data-outcome="Sitemark account active">
                            <h4>Sitemark Training</h4>
                            <p>Training on the field data collection tool</p>
                            <a href="https://pontiva.thinkific.com/courses/Sitemark" target="_blank" rel="noopener noreferrer" class="btn btn-secondary">
                                Access course
                            </a>
                            <div class="planb" data-planb="thinkific">
                                <button class="planb-toggle" aria-expanded="true">Plan B ¬∑ Thinkific</button>
                                <div class="planb-content">
                                    If the redirect fails: sign in to Thinkific ‚Üí open ‚ÄúMy Courses‚Äù ‚Üí search for Teams Planner / Sitemark ‚Üí Resume.
                                </div>
                            </div>
                        </div>
                        
                        <div class="task-item">
                            <h4>MS Project Training</h4>
                            <p>Essential basics of project management software</p>
                            <a href="" target="_blank" class="btn btn-secondary">
                                Start course
                            </a>
                        </div>
                    </div>
                </div>
            </section>

            <section class="project-section">
                <h2>Real project in hand ‚Äì What to do at that time</h2>
                
                    <div class="task-list">
                    <div class="task-item" data-role="apprenant" data-duration="10‚Äì15 min" data-outcome="Refresher done">
                        <h4>Review Teams Planner training</h4>
                        <p>Refresh your knowledge during your real project</p>
                        <a href="https://pontiva.thinkific.com/courses/PlanificateurTeams" target="_blank" rel="noopener noreferrer" class="btn btn-secondary">
                            Review training
                        </a>
                        <div class="planb" data-planb="thinkific">
                            <button class="planb-toggle" aria-expanded="true">Plan B ¬∑ Thinkific</button>
                            <div class="planb-content">
                                If the redirect fails: sign in to Thinkific ‚Üí open ‚ÄúMy Courses‚Äù ‚Üí search for Teams Planner / Sitemark ‚Üí Resume.
                            </div>
                        </div>
                    </div>
                    
                    <div class="task-item" data-role="apprenant" data-duration="20‚Äì30 min" data-outcome="Module completed">
                        <h4>Complete Sitemark training</h4>
                        <p>Complete the training alongside your project</p>
                        <a href="https://pontiva.thinkific.com/courses/Sitemark" target="_blank" rel="noopener noreferrer" class="btn btn-secondary">
                            Review training
                        </a>
                        <div class="planb" data-planb="thinkific">
                            <button class="planb-toggle" aria-expanded="true">Plan B ¬∑ Thinkific</button>
                            <div class="planb-content">
                                If the redirect fails: sign in to Thinkific ‚Üí open ‚ÄúMy Courses‚Äù ‚Üí search for Teams Planner / Sitemark ‚Üí Resume.
                            </div>
                        </div>
                    </div>
                    <div class="task-item" data-role="apprenant" data-duration="30‚Äì45 min" data-outcome="Practice done on project">
                        <h4>MS Project training on your real project</h4>
                        <a href="https://pontiva.thinkific.com/courses/processusmsparriv%C3%A9e" target="_blank" rel="noopener noreferrer" class="btn btn-secondary">
                            Work on your project
                        </a>
                        <div class="planb" data-planb="thinkific">
                            <button class="planb-toggle" aria-expanded="true">Plan B ¬∑ Thinkific</button>
                            <div class="planb-content">
                                If the redirect fails: sign in to Thinkific ‚Üí open ‚ÄúMy Courses‚Äù ‚Üí search for Teams Planner / Sitemark ‚Üí Resume.
                            </div>
                        </div>
                    </div>
                    
                    
                    <div class="task-item">
                        <h4>Contact Sitemark representatives</h4>
                        <p>Get in touch with the support team for project assistance</p>
                        <div class="contact-grid">
                            <div class="contact-item">
                                <strong>Technical support:</strong>
                                <a href="mailto:idris.abidi@sitemark.com" class="btn btn-contact">
                                    idris.abidi@sitemark.com
                                </a>
                            </div>
                            <div class="contact-item">
                                <strong>Commercial:</strong>
                                <a href="mailto:charles.andredumont@sitemark.com" class="btn btn-contact">
                                    charles.andredumont@sitemark.com
                                </a>
                            </div>
                            <div class="contact-item">
                                <strong>Operations:</strong>
                                <a href="mailto:operations1@sitemark.com" class="btn btn-contact">
                                    operations1@sitemark.com
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <section class="resources-section">
                <h3>üìö Additional Resources</h3>
                
                <!-- Dynamic VBA Macros Section -->
                <div class="macros-section">
                    <h4>üîß VBA Macros</h4>
                    <div id="macros-list" class="macros-grid">
                        <div class="loading-message">Loading macros...</div>
                    </div>
                </div>
                
                <!-- Other existing resources -->
                <div class="other-resources">
                    <h4>üîó Other resources</h4>
                    <div class="resource-grid">
                        <div class="resource-item">
                            <h4>MS Project Macros (SharePoint)</h4>
                                <a href="https://vincienergies.sharepoint.com/:f:/r/sites/GO-PlanificationPMO/Documents%20partages/General/Macro%20MSP?csf=1&web=1&e=jBa7Dm" target="_blank" rel="noopener noreferrer" class="btn btn-primary">
                                Open platform
                            </a>
                        </div>
                        
                        <div class="resource-item">
                            <h4>Teams Planner: Base EPC plan to put in your GO-Construction site</h4>
                            <a href="https://teams.microsoft.com/l/entity/com.microsoft.teamspace.tab.planner/mytasks?tenantId=cae7d061-08f3-40dd-80c3-3c0b8889224a&webUrl=https%3A%2F%2Ftasks.teams.microsoft.com%2Fteamsui%2FpersonalApp%2Falltasklists&context=%7B%22subEntityId%22%3A%22%2Fv1%2Fpremiumplan%2Ff19fc843-87b0-4cc2-96bd-c0cde78f7f79%2Forg%2F59675cc6-bab9-416e-b01c-04b99ae59f69%22%7D" target="_blank" rel="noopener noreferrer" class="btn btn-primary">
                                Open Teams
                            </a>
                            <div class="planb" data-planb="teams">
                                <button class="planb-toggle" aria-expanded="true">Plan B ¬∑ Teams</button>
                                <div class="planb-content">
                                    If the link does not open: Open Teams ‚Üí Tasks/Planner tab ‚Üí search for EPC Plan [plan name] in the Omexom team ‚Üí open List view.
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
        </main>

        <footer class="footer">
            <div class="footer-content">
                <div class="language-footer">
                    <a href="index.html">üá´üá∑</a>
                    <a href="index_inde.html">üáÆüá≥</a>
                </div>
                <div class="update-info" id="last-updated" aria-live="polite"></div>
            </div>
        </footer>
    </div>

    <script>
        // Dynamic loading of macros from manifest.json
        async function loadMacros() {
            const macrosContainer = document.getElementById('macros-list');
            
            try {
                const response = await fetch('./macros/manifest.json');
                
                if (!response.ok) {
                    throw new Error(`HTTP Error: ${response.status}`);
                }
                
                const data = await response.json();
                
                // Clear loading message
                macrosContainer.innerHTML = '';
                
                // Generate only supported cards (avoid 404 until all paths are normalized)
                const allowedNames = new Set([
                    'avancement-physique-vs-heures',
                    'calculatrice-reste-a-faire',
                    'creation-ms-project'
                ]);
                data.macros.filter(m => allowedNames.has(m.name)).forEach(macro => {
                    const macroCard = document.createElement('div');
                    macroCard.className = 'macro-card';
                    
                    // Encode URLs to handle spaces and special characters
                    const encodedHtmlFile = macro.htmlFile ? encodeURIComponent(macro.htmlFile).replace(/%2F/g, '/') : '';
                    const encodedBasFile = macro.basFile ? encodeURIComponent(macro.basFile).replace(/%2F/g, '/') : '';
                    
                    macroCard.innerHTML = `
                        <div class="macro-header">
                            <h5 class="macro-title">
                                <a href="./macros/${encodedHtmlFile}" target="_blank" class="macro-link">
                                    ${macro.title}
                                </a>
                            </h5>
                            ${macro.lastUpdated ? `<span class="macro-date">Updated on ${macro.lastUpdated}</span>` : ''}
                        </div>
                        <p class="macro-description">${macro.description}</p>
                        <div class="macro-actions">
                            <a href="./macros/${encodedHtmlFile}" target="_blank" class="btn btn-secondary btn-small">
                                üìñ Documentation
                            </a>
                            <a href="./macros/${encodedBasFile}" download class="btn btn-primary btn-small">
                                üíæ Download
                            </a>
                        </div>
                    `;
                    
                    macrosContainer.appendChild(macroCard);
                });
                
            } catch (error) {
                console.error('Error loading macros:', error);
                macrosContainer.innerHTML = `
                    <div class="error-message">
                        ‚ùå Unable to load VBA macros
                        <br><small>Please check that the manifest.json file is accessible</small>
                    </div>
                `;
            }
        }
        
        // Load macros when page loads
        document.addEventListener('DOMContentLoaded', loadMacros);
    </script>
    <script src="assets/onboarding.js"></script>
</body>
</html>
